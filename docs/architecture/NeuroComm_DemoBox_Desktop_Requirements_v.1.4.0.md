# NeuroComm DemoBox Desktop Application â€“ Architecture Requirements v.1.4.0

> **Ğ¡Ğ²ÑĞ·Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ñ‹:**  
> - `01_2026_NC_architecture_v1.4.0.md` (Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°)  
> - `NeuroComm_State_Diagrams_v1.4.0.md` (state diagrams)

## 1. Ğ¦ĞµĞ»ÑŒ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°

Ğ­Ñ‚Ğ¾Ñ‚ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ÑĞµÑ‚ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ½Ñ‹Ğµ Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğº desktop-Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ **NeuroComm DemoBox**, ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ¾Ğµ ÑĞ»ÑƒĞ¶Ğ¸Ñ‚ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ¼ Ğ´Ğ»Ñ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ, Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ¸ Ğ¸ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ° NeuroComm, ÑĞ¾ÑÑ‚Ğ¾ÑÑ‰ĞµĞ³Ğ¾ Ğ¸Ğ· 3 MCU (MCU1 - NASP digital twin, MCU2 - Product SoC, MCU3 - UI/Display).

ĞŸÑ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾:
- ĞĞ±ĞµÑĞ¿ĞµÑ‡Ğ¸Ñ‚ÑŒ ÑƒĞ´Ğ¾Ğ±Ğ½Ñ‹Ğ¹ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ Ğ´Ğ»Ñ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ² Ğ²ÑĞµÑ… Ñ€ĞµĞ¶Ğ¸Ğ¼Ğ¾Ğ² Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ°
- ĞŸÑ€ĞµĞ´Ğ¾ÑÑ‚Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹ Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ¸ Ğ¸ Ğ´Ğ¸Ğ°Ğ³Ğ½Ğ¾ÑÑ‚Ğ¸ĞºĞ¸ Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸
- ĞŸĞ¾Ğ·Ğ²Ğ¾Ğ»Ğ¸Ñ‚ÑŒ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ firmware ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ°
- Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñƒ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ğ¾Ğ² (VAD, SR, KWS, VE)
- ĞĞ±ĞµÑĞ¿ĞµÑ‡Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ğ¸ÑÑŒ Ğ¸ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· ÑĞµÑÑĞ¸Ğ¹ Ğ´Ğ»Ñ offline Ğ¸ÑÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

---

## 2. ĞĞ±Ñ‰Ğ°Ñ ĞºĞ¾Ğ½Ñ†ĞµĞ¿Ñ†Ğ¸Ñ

### 2.1 ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ

Desktop-Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ **NeuroComm DemoBox** â€” ÑÑ‚Ğ¾ Ğ¸Ğ½Ğ¶ĞµĞ½ĞµÑ€Ğ½Ñ‹Ğ¹ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚ Ğ´Ğ»Ñ:
- **Ğ Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸ĞºĞ¾Ğ²** â€” Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ° Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ğ¾Ğ², Ñ‚ÑĞ½Ğ¸Ğ½Ğ³ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ²
- **Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ñ‰Ğ¸ĞºĞ¾Ğ²** â€” Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ¾ÑĞ¿Ğ¾ÑĞ¾Ğ±Ğ½Ğ¾ÑÑ‚Ğ¸ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ°
- **Ğ”ĞµĞ¼Ğ¾Ğ½ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¹** â€” Ğ¿Ğ¾ĞºĞ°Ğ· Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ĞµĞ¹ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹

### 2.2 Ğ¦ĞµĞ»ĞµĞ²Ğ°Ñ Ğ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼Ğ°

- **ĞÑĞ½Ğ¾Ğ²Ğ½Ğ°Ñ:** Windows 10/11
- **Ğ–ĞµĞ»Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ°:** ĞºÑ€Ğ¾ÑÑ-Ğ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ (macOS, Linux)

### 2.3 ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ½Ñ‹Ğ¹ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´

ĞŸÑ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑÑ Ğ¿Ğ¾ Ğ¿Ñ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿Ñƒ **ĞºĞ»Ğ¸ĞµĞ½Ñ‚-ÑĞµÑ€Ğ²ĞµÑ€Ğ½Ğ¾Ğ¹ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ‹**:
- **Desktop UI** (frontend) â€” Ğ³Ñ€Ğ°Ñ„Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
- **Communication Layer** â€” Ğ¿Ñ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ» Ğ¾Ğ±Ğ¼ĞµĞ½Ğ° Ñ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ¾Ğ¼ Ñ‡ĞµÑ€ĞµĞ· USB/UART
- **Device** (backend) â€” MCU3 ĞºĞ°Ğº USB-Ğ¼Ğ¾ÑÑ‚ Ğº MCU1/MCU2

### 2.4 ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ°

Desktop-Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²ÑƒĞµÑ‚ Ñ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ¾Ğ¼ Ñ‡ĞµÑ€ĞµĞ· **MCU3 (USB bridge)**, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹ Ğ¿ĞµÑ€ĞµĞ´Ğ°Ñ‘Ñ‚ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ Ğ½Ğ°:

**MCU2 (Product SoC)** â€” master ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ»ĞµÑ€:
- State machine Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ°
- SR (Speaker Recognition)
- KWS (Keyword Spotting)
- PTT ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ
- ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ MCU1

**MCU1 (NASP digital twin)** â€” slave accelerator:
- VAD (Voice Activity Detection)
- VE (Voice Enhancement)
- ĞÑƒĞ´Ğ¸Ğ¾ routing
- Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ Ğ¾Ñ‚ MCU2

> **ĞšĞ Ğ˜Ğ¢Ğ˜Ğ§ĞĞ:** MCU1 Ğ½Ğµ Ğ·Ğ½Ğ°ĞµÑ‚ Ğ¾ Ñ€ĞµĞ¶Ğ¸Ğ¼Ğ°Ñ… AI-VOX/PRO/PRO+SR. Ğ­Ñ‚Ğ¸ Ñ€ĞµĞ¶Ğ¸Ğ¼Ñ‹ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‚ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ½Ğ° ÑƒÑ€Ğ¾Ğ²Ğ½Ğµ MCU2. Desktop-Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑÑ‚ÑŒ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ Ğ½Ğ° MCU2, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹ Ñ‚Ñ€Ğ°Ğ½ÑĞ»Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¸Ñ… Ğ² Ğ½Ğ¸Ğ·ĞºĞ¾ÑƒÑ€Ğ¾Ğ²Ğ½ĞµĞ²Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ Ğ´Ğ»Ñ MCU1.

---

## 3. ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ±Ğ»Ğ¾ĞºĞ¸

### 3.1 Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸ĞµĞ¼

**Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¸:**
- ĞŸĞ¾Ğ¸ÑĞº Ğ¸ Ğ¿ĞµÑ€ĞµÑ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ğµ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ñ… ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ² (USB VID/PID Ğ¸Ğ»Ğ¸ COM-Ğ¿Ğ¾Ñ€Ñ‚Ñ‹)
- ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ/Ğ¾Ñ‚ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ¾Ñ‚ Ğ²Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ°
- ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¿ĞµÑ€ĞµĞ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸ Ğ¿Ğ¾Ñ‚ĞµÑ€Ğµ ÑĞ²ÑĞ·Ğ¸
- Ğ˜Ğ½Ğ´Ğ¸ĞºĞ°Ñ†Ğ¸Ñ ÑÑ‚Ğ°Ñ‚ÑƒÑĞ° ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ñ

**Ğ¢Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:**
- ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¸Ñ… Ñ‚Ğ¸Ğ¿Ğ¾Ğ² Ñ„Ğ¸Ğ·Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ñ (USB CDC, UART over USB)
- ĞÑ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ Ğ¸Ğ´ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€Ğ° ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ° (serial number)
- ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ²ĞµÑ€ÑĞ¸Ğ¹ firmware

**Device Discovery:**
1. Ğ¡ĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ USB Ğ¿Ğ¾Ñ€Ñ‚Ğ¾Ğ² Ğ½Ğ° Ğ½Ğ°Ğ»Ğ¸Ñ‡Ğ¸Ğµ VID/PID ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ°
2. ĞĞ¿Ñ€Ğ¾Ñ serial numbers Ğ²ÑĞµÑ… Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ½Ñ‹Ñ… ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²
3. Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ Ñ‚Ğ¸Ğ¿Ñƒ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ° (NeuroComm DemoBox vs Ğ´Ñ€ÑƒĞ³Ğ¸Ğµ)
4. ĞÑ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ ÑĞ¿Ğ¸ÑĞºĞ° Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ñ… ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ² Ñ metadata:
   - Serial number
   - Firmware versions (MCU1/MCU2/MCU3)
   - Last seen timestamp
   - Connection status

**Handshake sequence Ğ¿Ñ€Ğ¸ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¸:**
```
App â†’ Device: HELLO (protocol version)
Device â†’ App: DEVICE_INFO (type, serial, fw_versions)
App â†’ Device: GET_STATUS()
Device â†’ App: STATUS (current mode, parameters, active streams)
App â†’ Device: GET_PARAMS()
Device â†’ App: PARAMS_SNAPSHOT (all current parameters)
App: Sync UI state with device state
App â†’ Device: READY
```

**Reconnection strategy:**
- ĞŸÑ€Ğ¸ Ğ¿Ğ¾Ñ‚ĞµÑ€Ğµ ÑĞ²ÑĞ·Ğ¸: 3 Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚ĞºĞ¸ Ğ¿ĞµÑ€ĞµĞ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ Ñ Ğ¸Ğ½Ñ‚ĞµÑ€Ğ²Ğ°Ğ»Ğ¾Ğ¼ 1 ÑĞµĞº
- Ğ•ÑĞ»Ğ¸ Ğ½ĞµÑƒÑĞ¿ĞµÑˆĞ½Ğ¾: Ğ¿ĞµÑ€ĞµÑ…Ğ¾Ğ´ Ğ² "Disconnected" mode Ñ Ğ¸Ğ½Ğ´Ğ¸ĞºĞ°Ñ†Ğ¸ĞµĞ¹
- Background monitoring: Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚ĞºĞ° Ğ¿ĞµÑ€ĞµĞ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ ĞºĞ°Ğ¶Ğ´Ñ‹Ğµ 5 ÑĞµĞº
- ĞŸÑ€Ğ¸ Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğ¸ ÑĞ²ÑĞ·Ğ¸: Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¹ handshake + resync state

**Conflict resolution:**
- Ğ•ÑĞ»Ğ¸ device state != app state Ğ¿Ğ¾ÑĞ»Ğµ reconnect:
  - ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ diff
  - ĞŸÑ€ĞµĞ´Ğ»Ğ¾Ğ¶Ğ¸Ñ‚ÑŒ: "Use device state" / "Push app state" / "Reset to defaults"

---

### 3.2 ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ Ñ€ĞµĞ¶Ğ¸Ğ¼Ğ¾Ğ² Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹

ĞŸÑ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ¿Ğ¾Ğ·Ğ²Ğ¾Ğ»ÑÑ‚ÑŒ Ğ½Ğ°ÑÑ‚Ñ€Ğ°Ğ¸Ğ²Ğ°Ñ‚ÑŒ 4 Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ñ… Ñ€ĞµĞ¶Ğ¸Ğ¼Ğ° Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ°:

#### Ğ ĞµĞ¶Ğ¸Ğ¼Ñ‹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹:
1. **AI-VOX** â€” Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ Ñ€ĞµĞ¶Ğ¸Ğ¼ Ñ VAD-ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸ĞµĞ¼ PTT
2. **AI-VOX PRO** â€” Ñ€ĞµĞ¶Ğ¸Ğ¼ Ñ KWS-ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ°Ğ¼Ğ¸ (ÑÑ‚Ğ°Ñ€Ñ‚Ğ¾Ğ²Ğ°Ñ, disconnect)
3. **AI-VOX PRO + SR** â€” Ñ€ĞµĞ¶Ğ¸Ğ¼ Ñ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸ĞµĞ¼ Speaker Recognition
4. **VE** â€” Ñ€ĞµĞ¶Ğ¸Ğ¼ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Voice Enhancement (Ğ±ĞµĞ· TX Ğ»Ğ¾Ğ³Ğ¸ĞºĞ¸)

**Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ñ€ĞµĞ¶Ğ¸Ğ¼Ğ°:**
- Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ñ€ĞµĞ¶Ğ¸Ğ¼Ğ° Ğ¸Ğ· ÑĞ¿Ğ¸ÑĞºĞ°
- ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° ÑĞ¿ĞµÑ†Ğ¸Ñ„Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ² Ñ€ĞµĞ¶Ğ¸Ğ¼Ğ°
- Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ² ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ¾
- Ğ˜Ğ½Ğ´Ğ¸ĞºĞ°Ñ†Ğ¸Ñ Ñ‚ĞµĞºÑƒÑ‰ĞµĞ³Ğ¾ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾Ğ³Ğ¾ Ñ€ĞµĞ¶Ğ¸Ğ¼Ğ°

#### 3.2.1 ĞœĞµÑ…Ğ°Ğ½Ğ¸ĞºĞ° Ñ€ĞµĞ¶Ğ¸Ğ¼Ğ¾Ğ²

**AI-VOX (Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹):**
- ĞŸĞµÑ€ĞµÑ…Ğ¾Ğ´ Ğ² TX: VAD Start (N_start Ñ‡Ğ°Ğ½ĞºĞ¾Ğ² Ğ³Ğ¾Ğ»Ğ¾ÑĞ° Ğ¿Ğ¾Ğ´Ñ€ÑĞ´)
- ĞŸĞµÑ€ĞµÑ…Ğ¾Ğ´ Ğ² RX: VAD Stop (M_stop Ñ‡Ğ°Ğ½ĞºĞ¾Ğ² Ñ‚Ğ¸ÑˆĞ¸Ğ½Ñ‹ Ğ¿Ğ¾Ğ´Ñ€ÑĞ´)
- ĞĞµÑ‚ session management
- PTT cycling Ğ¿Ğ¾ VAD Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸

**AI-VOX PRO (Ñ KWS):**
- Ğ¤Ğ°Ğ·Ğ° 1 (Idle): VAD + KWS ÑĞ»ÑƒÑˆĞ°ĞµÑ‚ ÑÑ‚Ğ°Ñ€Ñ‚Ğ¾Ğ²Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ (cmd 1-3)
- Ğ¤Ğ°Ğ·Ğ° 2 (Session Active): Ğ¿Ğ¾ÑĞ»Ğµ cmd â†’ ÑĞµÑÑĞ¸Ñ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚Ğ°, PTT=OFF, RX Ğ°ĞºÑ‚Ğ¸Ğ²ĞµĞ½
- Ğ¤Ğ°Ğ·Ğ° 3 (Transmission): VAD Start â†’ PTT=ON, VAD cycling Ğ¿Ğ¾ Ğ³Ğ¾Ğ»Ğ¾ÑÑƒ
- Ğ¤Ğ°Ğ·Ğ° 4 (Disconnect): cmd 4 Ğ¸Ğ»Ğ¸ Session Timeout â†’ PTT=OFF, Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚ Ğ² Idle
- **ĞšĞ»ÑÑ‡ĞµĞ²Ğ¾Ğµ Ğ¾Ñ‚Ğ»Ğ¸Ñ‡Ğ¸Ğµ Ğ¾Ñ‚ AI-VOX:** ÑĞµÑÑĞ¸Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ÑÑ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ°Ğ¼Ğ¸, Ğ° Ğ½Ğµ Ñ‡Ğ¸ÑÑ‚Ñ‹Ğ¼ VAD

**AI-VOX PRO + SR (Ñ Ğ²ĞµÑ€Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸ĞµĞ¹ Ğ³Ğ¾Ğ²Ğ¾Ñ€ÑÑ‰ĞµĞ³Ğ¾):**
- Ğ˜Ğ´ĞµĞ½Ñ‚Ğ¸Ñ‡Ğ½Ğ¾ AI-VOX PRO, Ğ½Ğ¾ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ¤Ğ°Ğ·Ğ¾Ğ¹ 1 Ğ¸ Ğ¤Ğ°Ğ·Ğ¾Ğ¹ 2 Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ° SR Ğ²ĞµÑ€Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ:
  - Ğ¤Ğ°Ğ·Ğ° 1.5: SR Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµÑ‚ Ñ‚Ğ¾Ñ‚ Ğ¶Ğµ KWS Ğ±ÑƒÑ„ĞµÑ€ (ÑÑ‚Ğ°Ñ€Ñ‚Ğ¾Ğ²ÑƒÑ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñƒ)
  - SR Confirmed â†’ beep Ğ¿Ğ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸Ñ â†’ Ğ¤Ğ°Ğ·Ğ° 2 (Session Active)
  - SR Rejected â†’ beep Ğ¾Ñ‚ĞºĞ°Ğ·Ğ° â†’ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚ Ğ² Idle
- **ĞšĞ»ÑÑ‡ĞµĞ²Ğ¾Ğµ Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ğµ:** SR Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ **Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¾Ğ´Ğ¸Ğ½ Ñ€Ğ°Ğ·** â€” Ğ½Ğ° Ğ±ÑƒÑ„ĞµÑ€ ÑÑ‚Ğ°Ñ€Ñ‚Ğ¾Ğ²Ğ¾Ğ¹ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹, Ğ½Ğµ Ğ½Ğ° Ğ²ĞµÑÑŒ Ñ€ĞµÑ‡ĞµĞ²Ğ¾Ğ¹ Ğ¿Ğ¾Ñ‚Ğ¾Ğº
- ĞŸĞ¾ÑĞ»Ğµ Ğ¿Ğ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸Ñ SR Ğ¾Ñ‚ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ÑÑ (ÑĞºĞ¾Ğ½Ğ¾Ğ¼Ğ¸Ñ Ñ€ĞµÑÑƒÑ€ÑĞ¾Ğ²)

**VE (Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Voice Enhancement):**
- ĞĞµÑ‚ TX Ğ»Ğ¾Ğ³Ğ¸ĞºĞ¸
- RX Ñ VE enhancement Ğ²ÑĞµĞ³Ğ´Ğ° Ğ°ĞºÑ‚Ğ¸Ğ²ĞµĞ½
- Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ VE Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ğ¾Ğ²

**UI Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ñ€ĞµĞ¶Ğ¸Ğ¼Ğ¾Ğ²:**
- Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğ¹ Ñ€ĞµĞ¶Ğ¸Ğ¼ â€” ĞºÑ€ÑƒĞ¿Ğ½Ñ‹Ğ¼ ÑˆÑ€Ğ¸Ñ„Ñ‚Ğ¾Ğ¼ Ğ² header
- Ğ¢ĞµĞºÑƒÑ‰Ğ°Ñ Ñ„Ğ°Ğ·Ğ° (Ğ´Ğ»Ñ PRO/PRO+SR) â€” Ğ¿Ğ¾Ğ´ Ñ€ĞµĞ¶Ğ¸Ğ¼Ğ¾Ğ¼
- Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¸Ğ½Ğ´Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑĞ° Ñ‡ĞµÑ€ĞµĞ· Ñ„Ğ°Ğ·Ñ‹
- Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ Ñ„Ğ¾Ñ€ÑĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚Ğ° Ğ² Idle (emergency stop)

---

### 3.3 ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ NeuroComm (MCU1)

Ğ‘Ğ»Ğ¾Ğº Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ² **VAD** Ğ¸ **VE** Ğ½Ğ° MCU1:

#### 3.3.1 VAD Parameters
| ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Ğ”Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½ | ĞŸĞ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ |
|----------|----------|----------|--------------|
| Mode | Ğ ĞµĞ¶Ğ¸Ğ¼ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ VAD | AI VOX / DISABLED | AI VOX |
| VE mode | Ğ ĞµĞ¶Ğ¸Ğ¼ Voice Enhancement | DISABLED / ENABLED / ALWAYS_ON | DISABLED |
| SR detection timeout | Ğ¢Ğ°Ğ¹Ğ¼Ğ°ÑƒÑ‚ Ğ´ĞµÑ‚ĞµĞºÑ†Ğ¸Ğ¸ SR (Ğ¼Ñ) | 0-1000 | 10 |
| Cmd detection timeout | Ğ¢Ğ°Ğ¹Ğ¼Ğ°ÑƒÑ‚ Ğ´ĞµÑ‚ĞµĞºÑ†Ğ¸Ğ¸ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ (Ğ¼Ñ) | 0-1000 | 10 |

#### 3.3.2 VAD Params (Ğ´ĞµÑ‚Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ)

**Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğµ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹:**
| ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Ğ”Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½ | ĞŸĞ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ |
|----------|----------|----------|--------------|
| VAD threshold | ĞŸĞ¾Ñ€Ğ¾Ğ³ VAD | 0.0-1.0 | 0.55 |
| VAD gain | Ğ£ÑĞ¸Ğ»ĞµĞ½Ğ¸Ğµ VAD | 0.0-10.0 | 1.00 |
| Start marker size | N_start (Ñ‡Ğ°Ğ½ĞºĞ¾Ğ² Ğ¿Ğ¾Ğ´Ñ€ÑĞ´ voice) | 1-100 | 4 |
| Stop marker size | M_stop (Ñ‡Ğ°Ğ½ĞºĞ¾Ğ² Ğ¿Ğ¾Ğ´Ñ€ÑĞ´ non-voice) | 1-100 | 5 |

**Timing Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹:**
| ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Ğ”Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½ | ĞŸĞ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ |
|----------|----------|----------|--------------|
| Chunk duration | Ğ Ğ°Ğ±Ğ¾Ñ‡Ğ¸Ğ¹ Ñ‡Ğ°Ğ½Ğº VAD | 8-32 ms | 16 ms |
| Process window | ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° VAD | 4-16 ms | 8 ms |
| Skip window | ĞŸÑ€Ğ¾Ğ¿ÑƒÑĞº Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°Ğ¼Ğ¸ | 0-16 ms | 8 ms |

**ĞœĞµÑ…Ğ°Ğ½Ğ¸ĞºĞ° ĞºĞ¾Ğ»ÑŒÑ†ĞµĞ²Ğ¾Ğ³Ğ¾ Ğ±ÑƒÑ„ĞµÑ€Ğ° (Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶Ğ°Ñ‚ÑŒ Ğ² UI/Ğ¿Ğ¾Ğ´ÑĞºĞ°Ğ·ĞºĞ°Ñ…):**
- Ğ Ğ°Ğ·Ğ¼ĞµÑ€ Ğ±ÑƒÑ„ĞµÑ€Ğ°: 10 Ñ‡Ğ°Ğ½ĞºĞ¾Ğ² Ã— 16 ms = **160 ms**
- Pre-roll Ğ´Ğ»Ñ Start marker: N_start Ã— 16 ms (Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ 64 ms)
- Output Start Marker = Current Position âˆ’ N_start Ñ‡Ğ°Ğ½ĞºĞ¾Ğ²
- ĞŸĞµÑ€Ğ²Ñ‹Ğµ N_start Ñ‡Ğ°Ğ½ĞºĞ¾Ğ² Ğ±ĞµÑ€ÑƒÑ‚ÑÑ Ñ€ĞµÑ‚Ñ€Ğ¾ÑĞ¿ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ Ğ¸Ğ· Ğ±ÑƒÑ„ĞµÑ€Ğ°

**Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ:**
ĞŸÑ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ:
- Ğ¢ĞµĞºÑƒÑ‰ÑƒÑ Ğ·Ğ°Ğ´ĞµÑ€Ğ¶ĞºÑƒ Ğ´ĞµÑ‚ĞµĞºÑ†Ğ¸Ğ¸: N_start Ã— chunk_ms
- ĞĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼ÑƒÑ Ğ³Ğ»ÑƒĞ±Ğ¸Ğ½Ñƒ Ğ±ÑƒÑ„ĞµÑ€Ğ°: max(N_start, M_stop) Ã— chunk_ms
- ĞŸÑ€ĞµĞ´ÑƒĞ¿Ñ€ĞµĞ¶Ğ´ĞµĞ½Ğ¸Ğµ, ĞµÑĞ»Ğ¸ Ğ±ÑƒÑ„ĞµÑ€ Ğ¿ĞµÑ€ĞµĞ¿Ğ¾Ğ»Ğ½ĞµĞ½

#### 3.3.3 VE Params

| ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Ğ”Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½ | ĞŸĞ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ |
|----------|----------|----------|--------------|
| VE mode | Ğ ĞµĞ¶Ğ¸Ğ¼ VE | DISABLED / ENABLED / ALWAYS_ON | DISABLED |
| VE Increase | ĞšĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚ ÑƒÑĞ¸Ğ»ĞµĞ½Ğ¸Ñ VE | 0.0-10.0 | 1.41 |
| VE Gain | ĞĞ±Ñ‰ĞµĞµ ÑƒÑĞ¸Ğ»ĞµĞ½Ğ¸Ğµ VE | 0.0-10.0 | 1.00 |
| RX VE enable | VE Ğ´Ğ»Ñ RX Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ° | 0/1 | 0 |
| TX VE enable | VE Ğ´Ğ»Ñ TX Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ° | 0/1 | 0 |

**ĞšĞ Ğ˜Ğ¢Ğ˜Ğ§ĞĞ«Ğ™ ĞšĞĞĞ¢Ğ ĞĞšĞ¢ VE:**

> âš ï¸ **Ğ•ÑĞ»Ğ¸ VE mode = DISABLED:**
> - VE output Ğ”ĞĞ›Ğ–Ğ•Ğ Ğ±Ñ‹Ñ‚ÑŒ Ñ€Ğ°Ğ²ĞµĞ½ VE input (bypass)
> - ĞĞ¸ĞºĞ°ĞºĞ¾Ğ³Ğ¾ mute
> - ĞĞ¸ĞºĞ°ĞºĞ¾Ğ³Ğ¾ "last buffer"
> - ĞĞ¸ĞºĞ°ĞºĞ¾Ğ³Ğ¾ undefined Ğ¿Ğ¾Ğ²ĞµĞ´ĞµĞ½Ğ¸Ñ

Ğ­Ñ‚Ğ¾ Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ°ĞºÑ‚ Ğ´Ğ»Ñ:
- Ğ¡Ñ‚Ğ°Ğ±Ğ¸Ğ»ÑŒĞ½Ğ¾Ğ¹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ KWS
- ĞĞ´Ğ½Ğ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ñ… RX/TX Ñ€ĞµĞ¶Ğ¸Ğ¼Ğ¾Ğ²
- Ğ ĞµĞ¶Ğ¸Ğ¼Ğ° VE_always_on

**UI Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:**
- ĞŸÑ€Ğ¸ VE mode = DISABLED Ğ²ÑĞµ VE-Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ñ‹ Ğ±Ñ‹Ñ‚ÑŒ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ¾ Ğ½ĞµĞ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹ (grayed out)
- ĞŸÑ€Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¸ VE mode Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñƒ Ğ½Ğ° ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ¾ Ğ¸ Ğ´Ğ¾Ğ¶Ğ´Ğ°Ñ‚ÑŒÑÑ Ğ¿Ğ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸Ñ
- Ğ•ÑĞ»Ğ¸ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ¾ Ğ½Ğµ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµÑ‚ BYPASS Ğ¿Ñ€Ğ¸ DISABLED, Ğ¿Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡Ğ½Ğ¾Ğµ Ğ¿Ñ€ĞµĞ´ÑƒĞ¿Ñ€ĞµĞ¶Ğ´ĞµĞ½Ğ¸Ğµ

#### 3.3.4 Session Params (Ğ´Ğ»Ñ AI-VOX PRO/PRO+SR)

| ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Ğ”Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½ | ĞŸĞ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ |
|----------|----------|----------|--------------|
| Session timeout | Ğ¢Ğ°Ğ¹Ğ¼Ğ°ÑƒÑ‚ Ğ½ĞµĞ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾Ğ¹ ÑĞµÑÑĞ¸Ğ¸ | 0-300 ÑĞµĞº | 30 ÑĞµĞº |
| Command timeout | Ğ¢Ğ°Ğ¹Ğ¼Ğ°ÑƒÑ‚ Ğ¾Ğ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ñ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ | 0-10 ÑĞµĞº | 5 ÑĞµĞº |

**Ğ›Ğ¾Ğ³Ğ¸ĞºĞ° Session Timeout:**
- Ğ¢Ğ°Ğ¹Ğ¼ĞµÑ€ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ÑÑ Ğ¿Ğ¾ÑĞ»Ğµ `CMD_DETECTED` Ğ¸Ğ»Ğ¸ `SR_CONFIRMED`
- ĞŸĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ÑÑ Ğ¿Ñ€Ğ¸ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¼ `VAD=ON` Ğ² Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾Ğ¹ ÑĞµÑÑĞ¸Ğ¸
- ĞŸÑ€Ğ¸ Ğ¸ÑÑ‚ĞµÑ‡ĞµĞ½Ğ¸Ğ¸ â†’ `SESSION_TIMEOUT` â†’ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚ Ğ² Idle

**UI:**
- ĞÑ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶Ğ°Ñ‚ÑŒ Ğ¾ÑÑ‚Ğ°Ğ²ÑˆĞµĞµÑÑ Ğ²Ñ€ĞµĞ¼Ñ ÑĞµÑÑĞ¸Ğ¸ Ğ² debug-Ğ¿Ğ°Ğ½ĞµĞ»Ğ¸
- Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¸Ğ½Ğ´Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑĞ° (progress bar)
- ĞŸÑ€ĞµĞ´ÑƒĞ¿Ñ€ĞµĞ¶Ğ´ĞµĞ½Ğ¸Ğµ Ğ·Ğ° 5 ÑĞµĞºÑƒĞ½Ğ´ Ğ´Ğ¾ Ğ¸ÑÑ‚ĞµÑ‡ĞµĞ½Ğ¸Ñ

---

### 3.4 ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ Input/Output

#### 3.4.1 Input Params
| ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Ğ”Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½ | ĞŸĞ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ |
|----------|----------|----------|--------------|
| Input mode | Ğ ĞµĞ¶Ğ¸Ğ¼ Ğ²Ñ…Ğ¾Ğ´Ğ° | BOTH_INPUTS / MIC_ONLY / SPK_ONLY | BOTH_INPUTS |
| First gain | Ğ£ÑĞ¸Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ³Ğ¾ Ğ²Ñ…Ğ¾Ğ´Ğ° | 0.0-10.0 | 1.00 |
| Second gain | Ğ£ÑĞ¸Ğ»ĞµĞ½Ğ¸Ğµ Ğ²Ñ‚Ğ¾Ñ€Ğ¾Ğ³Ğ¾ Ğ²Ñ…Ğ¾Ğ´Ğ° | 0.0-10.0 | 1.00 |

#### 3.4.2 Output Params
| ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Ğ”Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½ | ĞŸĞ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ |
|----------|----------|----------|--------------|
| First output gain | Ğ£ÑĞ¸Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ³Ğ¾ Ğ²Ñ‹Ñ…Ğ¾Ğ´Ğ° | 0.0-10.0 | 1.00 |
| Second output gain | Ğ£ÑĞ¸Ğ»ĞµĞ½Ğ¸Ğµ Ğ²Ñ‚Ğ¾Ñ€Ğ¾Ğ³Ğ¾ Ğ²Ñ‹Ñ…Ğ¾Ğ´Ğ° | 0.0-10.0 | 1.00 |

#### 3.4.3 Sensory Params (KWS)
| ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Ğ”Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½ | ĞŸĞ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ |
|----------|----------|----------|--------------|
| KWS timeout | Ğ¢Ğ°Ğ¹Ğ¼Ğ°ÑƒÑ‚ Sensory (Ğ¼Ñ) | 0-1000 | 0.00 |
| Sensory gain | Ğ£ÑĞ¸Ğ»ĞµĞ½Ğ¸Ğµ Ğ´Ğ»Ñ KWS | 0.0-10.0 | 1.00 |
| KWS audio source | Ğ˜ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸Ğº Ğ´Ğ»Ñ KWS | MIC_BYPASS / MIC_VE | MIC_BYPASS |

---

### 3.5 Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ·Ğ°Ğ¿Ğ¸ÑÑŒÑ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ°

**Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¸:**
- **Start** â€” Ğ·Ğ°Ğ¿ÑƒÑĞº Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ğ¾Ğ² Ğ½Ğ° ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğµ
- **Stop** â€” Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ğ¾Ğ²
- **Set params** â€” Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ² Ğ½Ğ° ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ¾
- Ğ˜Ğ½Ğ´Ğ¸ĞºĞ°Ñ†Ğ¸Ñ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ (Started / Stopped)

---

### 3.6 Debug Flags (Ğ¾Ñ‚Ğ»Ğ°Ğ´Ğ¾Ñ‡Ğ½Ğ°Ñ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ)

**ĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ Ñ„Ğ»Ğ°Ğ³Ğ¾Ğ²:**

**1. VAD Debug:**
| Flag | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | ĞĞ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ½Ğ° UART |
|------|----------|------------------|
| VAD_MAP | VAD bitmap (64-bit map Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ³Ğ¾Ğ»Ğ¾ÑĞ° Ğ¿Ğ¾ Ñ‡Ğ°Ğ½ĞºĞ°Ğ¼) | Ğ¡Ñ€ĞµĞ´Ğ½ÑÑ (ĞºĞ°Ğ¶Ğ´Ñ‹Ğµ 16 ms) |
| VAD_EXTENDED | Ğ Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ½Ğ°Ñ VAD Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ (confidence, levels) | Ğ’Ñ‹ÑĞ¾ĞºĞ°Ñ |
| VAD_BUFFER_STATE | Ğ¡Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ ĞºĞ¾Ğ»ÑŒÑ†ĞµĞ²Ğ¾Ğ³Ğ¾ Ğ±ÑƒÑ„ĞµÑ€Ğ° (fill level, markers) | ĞĞ¸Ğ·ĞºĞ°Ñ |

**2. Audio Debug:**
| Flag | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | ĞĞ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ½Ğ° UART |
|------|----------|------------------|
| RMS | RMS Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ Ğ°ÑƒĞ´Ğ¸Ğ¾ | Ğ¡Ñ€ĞµĞ´Ğ½ÑÑ |
| AUDIO_LEVELS | Peak/RMS Ğ¿Ğ¾ ĞºĞ°Ğ½Ğ°Ğ»Ğ°Ğ¼ (In1/In2/Out1/Out2) | Ğ¡Ñ€ĞµĞ´Ğ½ÑÑ |
| STREAM_STATUS | ĞĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ¸ Ğ¸ Ğ¸Ñ… Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ | ĞĞ¸Ğ·ĞºĞ°Ñ |

**3. Timing Debug:**
| Flag | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | ĞĞ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ½Ğ° UART |
|------|----------|------------------|
| MCU1 TIMER_A | Ğ¢Ğ°Ğ¹Ğ¼ĞµÑ€ A MCU1 (VAD processing time) | ĞĞ¸Ğ·ĞºĞ°Ñ |
| MCU1 TIMER_B | Ğ¢Ğ°Ğ¹Ğ¼ĞµÑ€ B MCU1 (VE processing time) | ĞĞ¸Ğ·ĞºĞ°Ñ |
| MCU2 TIMER_A | Ğ¢Ğ°Ğ¹Ğ¼ĞµÑ€ A MCU2 (KWS processing time) | ĞĞ¸Ğ·ĞºĞ°Ñ |
| MCU2 TIMER_B | Ğ¢Ğ°Ğ¹Ğ¼ĞµÑ€ B MCU2 (SR processing time) | ĞĞ¸Ğ·ĞºĞ°Ñ |

**4. Algorithm Debug:**
| Flag | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | ĞĞ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ½Ğ° UART |
|------|----------|------------------|
| KWS_CONFIDENCE | Sensory confidence scores | Ğ¡Ñ€ĞµĞ´Ğ½ÑÑ |
| SR_DISTANCE | Cosine distance values Ğ´Ğ»Ñ SR | Ğ¡Ñ€ĞµĞ´Ğ½ÑÑ |
| SR_EMBEDDINGS | SR embedding vectors (Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ´Ğ»Ñ offline Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°) | ĞÑ‡ĞµĞ½ÑŒ Ğ²Ñ‹ÑĞ¾ĞºĞ°Ñ |

**5. System Debug:**
| Flag | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | ĞĞ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ½Ğ° UART |
|------|----------|------------------|
| EXT_DEBUG | Ğ Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ½Ğ°Ñ Ğ¾Ñ‚Ğ»Ğ°Ğ´Ğ¾Ñ‡Ğ½Ğ°Ñ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ | Ğ’Ñ‹ÑĞ¾ĞºĞ°Ñ |
| STORAGE_HELPER_EXTENDED | Ğ Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ½Ğ°Ñ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ñ…Ñ€Ğ°Ğ½Ğ¸Ğ»Ğ¸Ñ‰Ğµ | ĞĞ¸Ğ·ĞºĞ°Ñ |
| NEUROCOMM_AI_BUFFER | Ğ‘ÑƒÑ„ĞµÑ€ AI NeuroComm (KWS/SR buffers) | ĞÑ‡ĞµĞ½ÑŒ Ğ²Ñ‹ÑĞ¾ĞºĞ°Ñ |
| VOICE_MAP | ĞšĞ°Ñ€Ñ‚Ğ° Ğ³Ğ¾Ğ»Ğ¾ÑĞ¾Ğ²Ğ¾Ğ¹ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸ | Ğ¡Ñ€ĞµĞ´Ğ½ÑÑ |

**UI Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:**
- Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ñ„Ğ»Ğ°Ğ³Ğ¾Ğ² Ğ¿Ğ¾ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸ÑĞ¼ (collapsible sections)
- Ğ˜Ğ½Ğ´Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€ Ğ½Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ Ğ½Ğ° UART Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ñ„Ğ»Ğ°Ğ³Ğ°
- ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¿Ñ€ĞµĞ´ÑƒĞ¿Ñ€ĞµĞ¶Ğ´ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸ Ğ¿ĞµÑ€ĞµĞ³Ñ€ÑƒĞ·ĞºĞµ ĞºĞ°Ğ½Ğ°Ğ»Ğ° (ÑÑƒĞ¼Ğ¼Ğ° > 80% Ğ¿Ñ€Ğ¾Ğ¿ÑƒÑĞºĞ½Ğ¾Ğ¹ ÑĞ¿Ğ¾ÑĞ¾Ğ±Ğ½Ğ¾ÑÑ‚Ğ¸)
- ĞŸÑ€ĞµÑĞµÑ‚Ñ‹: "Basic Debug", "Audio Debug", "Algorithm Debug", "Full Debug"
- Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ñ/Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ ĞºĞ¾Ğ¼Ğ±Ğ¸Ğ½Ğ°Ñ†Ğ¸Ğ¹ Ñ„Ğ»Ğ°Ğ³Ğ¾Ğ²
- Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ Ñ„Ğ»Ğ°Ğ³Ğ¾Ğ² Ğ¼ĞµĞ¶Ğ´Ñƒ ÑĞµĞ°Ğ½ÑĞ°Ğ¼Ğ¸
- ĞœĞ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ²Ğ»Ğ¸ÑĞ½Ğ¸Ğµ Ğ½Ğ° Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ°

---

### 3.7 Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¸ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³

#### 3.7.1 Real-time Ğ»Ğ¾Ğ³

**Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¸:**
- ĞÑ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹ Ğ¾Ñ‚ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ° Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸
- Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ Ñ‚Ğ¸Ğ¿Ñƒ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ (INFO, DEBUG, ERROR)
- Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ Ğ¸ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸ĞºÑƒ (MCU1, MCU2, MCU3, App)
- ĞŸĞ¾Ğ¸ÑĞº Ğ¿Ğ¾ Ğ»Ğ¾Ğ³Ñƒ (Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ²Ñ‹Ğ¹ Ğ¿Ğ¾Ğ¸ÑĞº + regex)
- Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ Ğ»Ğ¾Ğ³Ğ° Ğ² Ñ„Ğ°Ğ¹Ğ»
- Auto-scroll (Ñ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒÑ Ğ¾Ñ‚ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ)
- Ğ¦Ğ²ĞµÑ‚Ğ¾Ğ²Ğ¾Ğµ ĞºĞ¾Ğ´Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ¾ severity

**Ğ¢Ğ¸Ğ¿Ñ‹ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹:**
- ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ° (Ğ²ĞµÑ€ÑĞ¸Ğ¸ FW, ÑÑ‚Ğ°Ñ‚ÑƒÑ)
- ĞĞ¾Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ğ¾Ğ² (VAD, SR, KWS, VE)
- ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ (Start, Stop, Set params)
- ĞÑ‚Ğ»Ğ°Ğ´Ğ¾Ñ‡Ğ½Ñ‹Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ
- ĞÑˆĞ¸Ğ±ĞºĞ¸ Ğ¸ Ğ¿Ñ€ĞµĞ´ÑƒĞ¿Ñ€ĞµĞ¶Ğ´ĞµĞ½Ğ¸Ñ

**Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸ Ğ»Ğ¾Ğ³Ğ°:**
```
[timestamp] [severity] [source] message
[14:52:33.185] [INFO] [MCU2] VAD Start detected (chunk_id=64)
[14:52:33.201] [DEBUG] [MCU1] VAD_MAP: 0xFFFFFFFF00000000
[14:52:33.450] [ERROR] [MCU2] KWS buffer overflow
```

#### 3.7.2 VAD Map Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ

Ğ•ÑĞ»Ğ¸ Ğ²ĞºĞ»ÑÑ‡ĞµĞ½ Ñ„Ğ»Ğ°Ğ³ `VAD_MAP`:
- ĞÑ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ VAD bitmap Ğ² Ğ²Ğ¸Ğ´Ğµ Ğ³Ñ€Ğ°Ñ„Ğ¸ĞºĞ°/Ñ‚Ğ°Ğ¹Ğ¼Ğ»Ğ°Ğ¹Ğ½Ğ°
- Ğ¦Ğ²ĞµÑ‚Ğ¾Ğ²Ğ°Ñ Ğ¸Ğ½Ğ´Ğ¸ĞºĞ°Ñ†Ğ¸Ñ: Ğ³Ğ¾Ğ»Ğ¾Ñ (Ğ·ĞµĞ»ĞµĞ½Ñ‹Ğ¹) / Ñ‚Ğ¸ÑˆĞ¸Ğ½Ğ° (ÑĞµÑ€Ñ‹Ğ¹)
- Ğ’Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ°Ñ ÑˆĞºĞ°Ğ»Ğ° (ÑĞµĞºÑƒĞ½Ğ´Ñ‹)
- Zoom in/out Ğ´Ğ»Ñ Ğ´ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€Ğ°
- Ğ¡Ğ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ñ audio playback (ĞµÑĞ»Ğ¸ Ğ²ĞºĞ»ÑÑ‡ĞµĞ½Ğ° Ğ·Ğ°Ğ¿Ğ¸ÑÑŒ)

#### 3.7.3 Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ°

ĞŸĞ°Ğ½ĞµĞ»ÑŒ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ñ‚ĞµĞºÑƒÑ‰ĞµĞ³Ğ¾ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ:
- Ğ ĞµĞ¶Ğ¸Ğ¼ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ (AI-VOX / PRO / PRO+SR / VE)
- Ğ¡Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ ÑĞµÑÑĞ¸Ğ¸ (Idle / Command Detected / SR Confirmed/Rejected / Session Active)
- VAD ÑÑ‚Ğ°Ñ‚ÑƒÑ (ON / OFF) Ñ timestamp Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½ĞµĞ³Ğ¾ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ
- PTT ÑÑ‚Ğ°Ñ‚ÑƒÑ (ON / OFF) Ñ timestamp Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½ĞµĞ³Ğ¾ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ
- Firmware versions (MCU1, MCU2, MCU3)
- Connection status (Connected / Disconnected / Reconnecting)
- Uptime ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ°

#### 3.7.4 KWS/SR Monitoring

**KWS Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ:**
- Real-time confidence graph Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¹ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ (cmd 1-4)
- Threshold line (Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ğ¾Ñ€Ğ¾Ğ³ ÑÑ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ğ½Ğ¸Ñ)
- History: Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ 10 Ğ´ĞµÑ‚ĞµĞºÑ†Ğ¸Ğ¹ Ñ timestamp Ğ¸ confidence
- Audio waveform Ğ² Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚ Ğ´ĞµÑ‚ĞµĞºÑ†Ğ¸Ğ¸ (mini-spectrogram)

**SR Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ:**
- Cosine distance value (Ñ‡Ğ¸ÑĞ»Ğ¾Ğ²Ğ¾Ğµ + progress bar)
- Threshold (D_T) â€” Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ°Ñ Ğ»Ğ¸Ğ½Ğ¸Ñ
- CDF value (ĞµÑĞ»Ğ¸ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ)
- Embedding visualization (2D projection Ñ‡ĞµÑ€ĞµĞ· PCA, Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)
- Known speakers list Ñ centroid info

**Ğ˜Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ KWS Monitor                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Cmd 1 (Alpha):   â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘ 42%             â”‚
â”‚ Cmd 2 (Bravo):   â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 18%             â”‚
â”‚ Cmd 3 (Charlie): â–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 12%             â”‚
â”‚ Cmd 4 (Disconnect): â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 3%           â”‚
â”‚                                             â”‚
â”‚ Last detection: Cmd 1 at 14:52:33 (89%)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ SR Monitor                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Distance: 0.142 [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘] < 0.47 (D_T)   â”‚
â”‚ Status: âœ“ Speaker Known                     â”‚
â”‚                                             â”‚
â”‚ Centroid: [0.23, -0.15, 0.41, ...] (256d)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.7.5 Audio Streams Monitoring

**Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¸:**
- Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ñ… Ğ°ÑƒĞ´Ğ¸Ğ¾ Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ² Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸
- Ğ˜Ğ½Ğ´Ğ¸ĞºĞ°Ñ†Ğ¸Ñ Ğ½Ğ°Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ (MCU1â†’MCU2, MCU2â†’DAC)
- Ğ£Ñ€Ğ¾Ğ²Ğ½Ğ¸ Ğ°ÑƒĞ´Ğ¸Ğ¾ (peak/RMS) Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ°
- Bandwidth usage (Ğ¿Ñ€Ğ¾Ñ†ĞµĞ½Ñ‚ Ğ¾Ñ‚ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾Ğ¹ Ğ¿Ñ€Ğ¾Ğ¿ÑƒÑĞºĞ½Ğ¾Ğ¹ ÑĞ¿Ğ¾ÑĞ¾Ğ±Ğ½Ğ¾ÑÑ‚Ğ¸ UART)

**ĞÑ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶Ğ°ĞµĞ¼Ñ‹Ğµ Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ¸:**
- RX_STREAM_OUT (Radio SPK â†’ Headset)
- TX_AUDIO_OUT (MIC â†’ Radio TX)
- MIC_BYPASS (Ğ´Ğ»Ñ KWS)
- MIC_VE (Ğ´Ğ»Ñ KWS Ñ VE)

**UI:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Audio Streams                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ RX_STREAM_OUT:  [ACTIVE] â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ -18 dB  â”‚
â”‚ MCU1 â†’ MCU2 â†’ DAC_OUT2 â†’ Headset            â”‚
â”‚                                             â”‚
â”‚ TX_AUDIO_OUT:   [ACTIVE] â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ -24 dB  â”‚
â”‚ MIC â†’ MCU1 â†’ MCU2 â†’ DAC_OUT1 â†’ Radio        â”‚
â”‚                                             â”‚
â”‚ MIC_BYPASS:     [INACTIVE]                  â”‚
â”‚                                             â”‚
â”‚ UART Load: [â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘] 38% (500 kbaud)     â”‚
â”‚ âš ï¸ Enabling >1 stream may cause overload    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Bandwidth calculator:**
- ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ñ€Ğ°ÑÑ‡ĞµÑ‚ Ğ½Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ Ğ¿Ñ€Ğ¸ Ğ²ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¸ Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ°
- ĞŸÑ€ĞµĞ´ÑƒĞ¿Ñ€ĞµĞ¶Ğ´ĞµĞ½Ğ¸Ğµ Ğ¿ĞµÑ€ĞµĞ´ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ°Ñ†Ğ¸ĞµĞ¹, ĞµÑĞ»Ğ¸ Ğ½Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° >80%
- Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ğ¾ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ (ĞºĞ°ĞºĞ¸Ğµ Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ¸ Ğ¾Ñ‚ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ)

---

### 3.8 Firmware Update

**ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ:**

Desktop-Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²ÑƒĞµÑ‚ Ñ **MCU3 (bootloader)**, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹:
- ĞŸĞµÑ€ĞµĞ½Ğ°Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ firmware Ğ½Ğ° Ñ†ĞµĞ»ĞµĞ²Ğ¾Ğ¹ MCU
- Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºÑƒ Ñ†ĞµĞ»Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚Ğ¸
- Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ¼ Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸

**ĞŸÑ€Ğ¾Ñ†ĞµÑÑ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ:**

1. **Ğ’Ñ‹Ğ±Ğ¾Ñ€ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸:**
   - Dropdown: ncm-gen1.3, ncm-gen1.4, custom
   - Ğ”Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¹ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸ â€” ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ñ… firmware Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²

2. **Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ñ†ĞµĞ»ĞµĞ²Ğ¾Ğ³Ğ¾ MCU:**
   - MCU1 (NASP digital twin)
   - MCU2 (Product SoC)
   - MCU3 (UI/Display)
   - All (Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ²ÑĞµ MCU Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾)

3. **Sync Configurations:**
   - Ğ¡Ñ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ Ñ‚ĞµĞºÑƒÑ‰Ğ¸Ğµ Ğ²ĞµÑ€ÑĞ¸Ğ¸ FW Ñ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ°
   - Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ñ‚ÑŒ Ñ Ğ²Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ½Ğ¾Ğ¹ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸ĞµĞ¹
   - ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ diff (Ñ‡Ñ‚Ğ¾ Ğ±ÑƒĞ´ĞµÑ‚ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¾)
   - ĞŸÑ€ĞµĞ´ÑƒĞ¿Ñ€ĞµĞ¶Ğ´ĞµĞ½Ğ¸Ğµ Ğ¾ Ğ½ĞµÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ñ‹Ñ… Ğ²ĞµÑ€ÑĞ¸ÑÑ…

4. **Flash:**
   - ĞŸĞµÑ€ĞµĞ²ĞµÑÑ‚Ğ¸ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ¾ Ğ² bootloader mode
   - ĞŸĞµÑ€ĞµĞ´Ğ°Ñ‚ÑŒ firmware Ğ¿Ğ¾ USB
   - MCU3 Ğ¿ĞµÑ€ĞµĞ½Ğ°Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ½Ğ° Ñ†ĞµĞ»ĞµĞ²Ğ¾Ğ¹ MCU Ñ‡ĞµÑ€ĞµĞ· UART
   - Progress bar: Ğ¿Ñ€Ğ¾Ñ†ĞµĞ½Ñ‚Ñ‹ + estimated time remaining
   - Verification Ğ¿Ğ¾ÑĞ»Ğµ Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸
   - ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ°

5. **Post-flash verification:**
   - ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ½Ğ¾Ğ²Ñ‹Ğµ Ğ²ĞµÑ€ÑĞ¸Ğ¸ FW
   - Ğ’Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ¿Ñ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰ÑƒÑ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ²
   - Ğ¢ĞµÑÑ‚ ÑĞ²ÑĞ·Ğ¸ Ñ ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¼ MCU

**Ğ˜Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Firmware Update                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Configuration:  [ncm-gen1.3 â–¼]              â”‚
â”‚                                             â”‚
â”‚ Device:         [336234593133 â–¼]            â”‚
â”‚                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ MCU1: v1.5.0 â†’ v1.6.0 âœ“                 â”‚ â”‚
â”‚ â”‚ MCU2: v1.2.0-rc8 â†’ v1.2.0-rc8 (skip)    â”‚ â”‚
â”‚ â”‚ MCU3: v1.1.0-rc12 â†’ v1.2.0-rc12 âœ“       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                             â”‚
â”‚ [Sync Configurations]  [Flash]              â”‚
â”‚                                             â”‚
â”‚ Progress: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 52%            â”‚
â”‚ Status: Flashing MCU1... (35 sec remaining) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ:**
- Backup Ñ‚ĞµĞºÑƒÑ‰ĞµĞ¹ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ² Ğ¿ĞµÑ€ĞµĞ´ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸ĞµĞ¼
- Rollback Ğ¿Ñ€Ğ¸ Ğ¾ÑˆĞ¸Ğ±ĞºĞµ (Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ¸Ğ»Ğ¸ Ğ¿Ğ¾ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑƒ)
- ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞ¸ firmware (ĞµÑĞ»Ğ¸ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµÑ‚ÑÑ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ¾Ğ¼)
- ĞŸÑ€ĞµĞ´ÑƒĞ¿Ñ€ĞµĞ¶Ğ´ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸ Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚ĞºĞµ downgrade Ğ²ĞµÑ€ÑĞ¸Ğ¸
- Ğ‘Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²ĞºĞ° UI Ğ²Ğ¾ Ğ²Ñ€ĞµĞ¼Ñ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ (Ğ½ĞµĞ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹)

**ĞÑˆĞ¸Ğ±ĞºĞ¸:**
- Connection lost during flash â†’ Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚ĞºĞ° Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ
- Verification failed â†’ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ñ‚ÑŒ Ğ¸Ğ»Ğ¸ rollback
- Incompatible firmware â†’ Ğ¿Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ requirements Ğ¸ current state

---

### 3.9 Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ¸ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¹

**Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¸:**
- Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ñ‚ĞµĞºÑƒÑ‰Ğ¸Ñ… Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ² Ğ² Ñ„Ğ°Ğ¹Ğ» (.json, .yaml)
- Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ² Ğ¸Ğ· Ñ„Ğ°Ğ¹Ğ»Ğ°
- ĞŸÑ€ĞµÑĞµÑ‚Ñ‹ ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ñ… ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¹
- Export/Import ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¹ Ğ¼ĞµĞ¶Ğ´Ñƒ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ°Ğ¼Ğ¸
- Version control Ğ´Ğ»Ñ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¹ (track changes)

**Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ñ„Ğ°Ğ¹Ğ»Ğ° ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸ (.json):**
```json
{
  "version": "2.0",
  "device_type": "NeuroComm_DemoBox",
  "timestamp": "2026-02-12T14:52:33Z",
  "mode": "AI-VOX PRO + SR",
  "parameters": {
    "vad": {
      "threshold": 0.55,
      "gain": 1.0,
      "start_marker_size": 4,
      "stop_marker_size": 5,
      "chunk_ms": 16
    },
    "ve": {
      "mode": "ENABLED",
      "increase": 1.41,
      "gain": 1.0,
      "rx_enable": 1,
      "tx_enable": 1
    },
    "session": {
      "timeout": 30,
      "command_timeout": 5
    },
    "input": { ... },
    "output": { ... },
    "sensory": { ... }
  },
  "debug_flags": {
    "VAD_MAP": true,
    "RMS": true,
    ...
  }
}
```

---

### 3.10 State Machine Visualization

**Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¸:**
- Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ñ‚ĞµĞºÑƒÑ‰ĞµĞ³Ğ¾ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ state machine ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ° Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸
- ĞÑ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ Ğ¿ĞµÑ€ĞµÑ…Ğ¾Ğ´Ğ¾Ğ² ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğ¹ (Ñ Ñ‚Ğ°Ğ¹Ğ¼ÑÑ‚ĞµĞ¼Ğ¿Ğ°Ğ¼Ğ¸)
- Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ Ğ¿ĞµÑ€ĞµÑ…Ğ¾Ğ´Ğ¾Ğ² (Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ 50-100)

**Ğ¡Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ:**

**AI-VOX:**
```
Idle â†’ BufferFilling â†’ VAD Start â†’ Output â†’ VAD Stop â†’ Idle
```

**AI-VOX PRO:**
```
Idle â†’ BufferFilling â†’ VAD Start â†’ KWS Detection â†’ 
â†’ Cmd Detected â†’ Session Active (PTT OFF) â†’ VAD Start â†’ PTT ON â†’ 
â†’ VAD cycling... â†’ Disconnect|Timeout â†’ Idle
```

**AI-VOX PRO + SR:**
```
Idle â†’ BufferFilling â†’ VAD Start â†’ KWS Detection â†’ Cmd Detected â†’ 
â†’ SR Verification â†’ [SR Confirmed â†’ Session Active] | [SR Rejected â†’ Idle] â†’
â†’ VAD Start â†’ PTT ON â†’ VAD cycling... â†’ Disconnect|Timeout â†’ Idle
```

**UI ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ñ‹:**
- Ğ”Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğ¹ (Ğ³Ñ€Ğ°Ñ„Ğ¸Ñ‡ĞµÑĞºĞ°Ñ, Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ÑĞµÑ‚ÑÑ Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸)
- Ğ¢ĞµĞºÑƒÑ‰ĞµĞµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ (ĞºÑ€ÑƒĞ¿Ğ½Ñ‹Ğ¼ ÑˆÑ€Ğ¸Ñ„Ñ‚Ğ¾Ğ¼, Ñ†Ğ²ĞµÑ‚Ğ¾Ğ²Ğ°Ñ Ğ¸Ğ½Ğ´Ğ¸ĞºĞ°Ñ†Ğ¸Ñ)
- Ğ¢Ğ°Ğ¹Ğ¼ĞµÑ€ Ğ² ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğ¸ (ÑĞºĞ¾Ğ»ÑŒĞºĞ¾ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ Ğ² Ñ‚ĞµĞºÑƒÑ‰ĞµĞ¼ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğ¸)
- Ğ›Ğ¾Ğ³ Ğ¿ĞµÑ€ĞµÑ…Ğ¾Ğ´Ğ¾Ğ² (timestamp, from_state, to_state, trigger)

**Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ-Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ñ‹ Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ:**
- VAD Start/Stop
- KWS Command Detected (Ğ½Ğ¾Ğ¼ĞµÑ€ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹)
- SR Confirmed/Rejected
- Session Active/Closed/Timeout
- PTT ON/OFF

**Ğ¦Ğ²ĞµÑ‚Ğ¾Ğ²Ğ°Ñ ÑÑ…ĞµĞ¼Ğ°:**
- Idle â€” ÑĞµÑ€Ñ‹Ğ¹
- Active processing (BufferFilling, KWS Detection, SR Verification) â€” Ğ¶ĞµĞ»Ñ‚Ñ‹Ğ¹
- Session Active â€” ÑĞ¸Ğ½Ğ¸Ğ¹
- PTT ON (transmission) â€” Ğ·ĞµĞ»ĞµĞ½Ñ‹Ğ¹
- Error states (SR Rejected, Timeout) â€” ĞºÑ€Ğ°ÑĞ½Ñ‹Ğ¹

---

### 3.11 Offline Audio Analysis

**Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¸:**
- Ğ—Ğ°Ğ¿Ğ¸ÑÑŒ raw audio Ñ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ° (PCM, WAV)
- Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ debug telemetry (CSV, JSON)
- Replay Ğ·Ğ°Ğ¿Ğ¸ÑĞ°Ğ½Ğ½Ñ‹Ñ… ÑĞµÑÑĞ¸Ğ¹ Ñ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸ĞµĞ¹
- Post-processing Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· (VAD accuracy, SR distance distribution)



#### 3.11.1 Audio Codecs Support

**ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµĞ¼Ñ‹Ğµ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ñ‹:**

1. **PCM (Raw)**:
   - Format: PCM16 mono 16 kHz, little-endian
   - Use case: ĞœĞ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ ĞºĞ°Ñ‡ĞµÑÑ‚Ğ²Ğ¾, no compression
   - File size: ~1.9 MB/min
   - Library: wave (Python built-in), libsndfile (C++)

2. **LC3 (Bluetooth Low Complexity)**:
   - Format: LC3-compressed audio
   - Use case: ĞŸĞµÑ€ĞµĞ´Ğ°Ñ‡Ğ° Ğ¿Ğ¾ BLE, ÑĞºĞ¾Ğ½Ğ¾Ğ¼Ğ¸Ñ bandwidth
   - File size: ~100-200 KB/min (Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ñ‚ Ğ¾Ñ‚ bitrate)
   - Decoder: liblc3 (via ctypes/cffi)
   - Source: MCU2 Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ¿ĞµÑ€ĞµĞ´Ğ°Ğ²Ğ°Ñ‚ÑŒ LC3-compressed frames Ğ´Ğ»Ñ ÑĞºĞ¾Ğ½Ğ¾Ğ¼Ğ¸Ğ¸ UART bandwidth

3. **FLAC (Lossless)**:
   - Format: FLAC-compressed audio
   - Use case: ĞÑ€Ñ…Ğ¸Ğ²Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°Ğ¿Ğ¸ÑĞµĞ¹, lossless compression
   - File size: ~600-800 KB/min
   - Library: libFLAC, soundfile

**LC3 Decoder Integration:**

```python
# LC3 Decoder integration example
from ctypes import CDLL, c_int, c_float, c_char_p, POINTER
import numpy as np

# Load LC3 decoder library (platform-specific)
import platform
if platform.system() == 'Windows':
    liblc3 = CDLL("liblc3_decoder.dll")
elif platform.system() == 'Darwin':
    liblc3 = CDLL("liblc3_decoder.dylib")
else:
    liblc3 = CDLL("liblc3_decoder.so")

# Decoder function signature
liblc3.lc3_decode.argtypes = [
    POINTER(c_char),  # encoded_data
    c_int,            # encoded_size
    POINTER(c_float), # decoded_output
    c_int             # output_size
]
liblc3.lc3_decode.restype = c_int

def decode_lc3_frame(encoded_data: bytes) -> np.ndarray:
    """Decode LC3 frame to PCM"""
    output = np.zeros(240, dtype=np.float32)  # 15ms @ 16kHz
    result = liblc3.lc3_decode(
        encoded_data,
        len(encoded_data),
        output.ctypes.data_as(POINTER(c_float)),
        len(output)
    )
    if result != 0:
        raise RuntimeError(f"LC3 decode error: {result}")
    return output
```

**Protocol messages Ğ´Ğ»Ñ audio data:**

Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ² Ñ€Ğ°Ğ·Ğ´ĞµĞ» 4.2 (Protocol messages):
```
AUDIO_DATA_LC3    # LC3-compressed audio frame (from MCU2)
AUDIO_DATA_PCM    # Raw PCM audio frame (for debugging)
```

**UI requirements:**
- Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ° Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸ (PCM / LC3 / FLAC) Ğ² Recording Panel
- Ğ˜Ğ½Ğ´Ğ¸ĞºĞ°Ñ†Ğ¸Ñ ĞºĞ¾Ğ´ĞµĞºĞ° Ğ¿Ñ€Ğ¸ Ğ²Ğ¾ÑĞ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğ¸
- ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ ĞºĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ¼ĞµĞ¶Ğ´Ñƒ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ°Ğ¼Ğ¸
- Progress indicator Ğ´Ğ»Ñ compression/decompression


**Recording Ñ€ĞµĞ¶Ğ¸Ğ¼Ñ‹:**

1. **MIC raw** (Ğ²Ñ…Ğ¾Ğ´ VAD, Ğ´Ğ¾ VE):
   - Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚: PCM16 mono 16 kHz
   - Ğ˜ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸Ğº: MIC_BYPASS stream
   - Use case: Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· Ñ‡Ğ¸ÑÑ‚Ğ¾Ğ³Ğ¾ Ğ²Ñ…Ğ¾Ğ´Ğ°, Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ADC

2. **MIC after VE**:
   - Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚: PCM16 mono 16 kHz
   - Ğ˜ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸Ğº: MIC_VE stream
   - Use case: Ğ¾Ñ†ĞµĞ½ĞºĞ° ĞºĞ°Ñ‡ĞµÑÑ‚Ğ²Ğ° VE

3. **KWS input** (Ñ‡Ñ‚Ğ¾ Ğ¿Ğ¾Ğ´Ğ°Ñ‘Ñ‚ÑÑ Ğ½Ğ° KWS):
   - Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚: PCM16 mono 16 kHz
   - Ğ˜ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸Ğº: MIC_BYPASS Ğ¸Ğ»Ğ¸ MIC_VE (Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ñ‚ Ğ¾Ñ‚ Ñ€ĞµĞ¶Ğ¸Ğ¼Ğ°)
   - Use case: Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ° KWS Ğ´ĞµÑ‚ĞµĞºÑ†Ğ¸Ğ¸

4. **Full session** (Ğ²ÑĞµ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ + audio):
   - Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚: ZIP-Ğ°Ñ€Ñ…Ğ¸Ğ² Ñ WAV + JSON metadata
   - Ğ¡Ğ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ğ¼Ğ¾Ğµ:
     - mic_raw.wav
     - mic_ve.wav (ĞµÑĞ»Ğ¸ VE enabled)
     - rx_stream.wav (ĞµÑĞ»Ğ¸ RX Ğ°ĞºÑ‚Ğ¸Ğ²ĞµĞ½)
     - events.json (timestamp, type, payload Ğ´Ğ»Ñ Ğ²ÑĞµÑ… ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹)
     - vad_map.csv (VAD bitmap Ğ¿Ğ¾ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸)
     - session_metadata.json (Ñ€ĞµĞ¶Ğ¸Ğ¼, Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹, versions)

**Replay interface:**
- Timeline Ñ Ğ¼Ğ°Ñ€ĞºĞµÑ€Ğ°Ğ¼Ğ¸ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹ (VAD Start/Stop, KWS, SR, PTT)
- Sync playback audio + visualization
- Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ Ğ·Ğ°Ğ¼ĞµĞ´Ğ»ĞµĞ½Ğ¸Ñ/ÑƒÑĞºĞ¾Ñ€ĞµĞ½Ğ¸Ñ (0.25x - 2x)
- Export Ğ²Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ½Ñ‹Ñ… Ñ„Ñ€Ğ°Ğ³Ğ¼ĞµĞ½Ñ‚Ğ¾Ğ²

**Post-processing Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·:**
- VAD accuracy metrics (ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ ground truth Ğ°Ğ½Ğ½Ğ¾Ñ‚Ğ°Ñ†Ğ¸Ğ¸)
- SR distance distribution histogram
- KWS false positive/negative rate
- Audio quality metrics (SNR, THD)

---

### 3.12 Log File Management

**Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¸:**
- ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ²ÑĞµÑ… Ğ»Ğ¾Ğ³Ğ¾Ğ² ÑĞµÑÑĞ¸Ğ¸
- ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° Ğ¿Ğ¾Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ¸ Ñ€Ğ¾Ñ‚Ğ°Ñ†Ğ¸Ğ¸ Ğ»Ğ¾Ğ³Ğ¾Ğ²
- Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ Ğ»Ğ¾Ğ³Ğ¾Ğ² Ğ² Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ°Ñ…
- ĞŸĞ¾Ğ¸ÑĞº Ğ¸ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ Ğ°Ñ€Ñ…Ğ¸Ğ²Ğ½Ñ‹Ğ¼ Ğ»Ğ¾Ğ³Ğ°Ğ¼

**ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ:**

**Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ¸Ğ¼ĞµĞ½Ğ¸ Ñ„Ğ°Ğ¹Ğ»Ğ°:**
```
neurocomm_log_YYYYMMDD_HHMMSS_[device_serial].log
neurocomm_log_20260212_145233_336234593133.log
```

**Ğ”Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ñ Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ:**
- Windows: `%APPDATA%\NeuroComm\logs\`
- macOS: `~/Library/Application Support/NeuroComm/logs/`
- Linux: `~/.config/neurocomm/logs/`

**ĞŸĞ¾Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ° Ñ€Ğ¾Ñ‚Ğ°Ñ†Ğ¸Ğ¸:**

| ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | ĞŸĞ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ | ĞĞ°ÑÑ‚Ñ€Ğ°Ğ¸Ğ²Ğ°ĞµÑ‚ÑÑ |
|----------|----------|--------------|---------------|
| Max file size | ĞœĞ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€ Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾ Ğ»Ğ¾Ğ³-Ñ„Ğ°Ğ¹Ğ»Ğ° | 50 MB | Ğ”Ğ° (10-500 MB) |
| Max files | ĞœĞ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² | 100 | Ğ”Ğ° (10-1000) |
| Retention period | ĞŸĞµÑ€Ğ¸Ğ¾Ğ´ Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ñ ÑÑ‚Ğ°Ñ€Ñ‹Ñ… Ğ»Ğ¾Ğ³Ğ¾Ğ² | 30 Ğ´Ğ½ĞµĞ¹ | Ğ”Ğ° (7-365 Ğ´Ğ½ĞµĞ¹) |
| Auto-compress | Ğ¡Ğ¶Ğ°Ñ‚Ğ¸Ğµ ÑÑ‚Ğ°Ñ€Ñ‹Ñ… Ğ»Ğ¾Ğ³Ğ¾Ğ² (gzip) | Ğ”Ğ° (>7 Ğ´Ğ½ĞµĞ¹) | Ğ”Ğ° |
| Auto-delete | ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ ÑÑ‚Ğ°Ñ€Ñ‹Ñ… Ğ»Ğ¾Ğ³Ğ¾Ğ² | Ğ”Ğ° | Ğ”Ğ° |

**Ğ Ğ¾Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ¸ÑÑ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ¿Ñ€Ğ¸:**
- Ğ”Ğ¾ÑÑ‚Ğ¸Ğ¶ĞµĞ½Ğ¸Ğ¸ max file size
- Ğ¡Ñ‚Ğ°Ñ€Ñ‚Ğµ Ğ½Ğ¾Ğ²Ğ¾Ğ¹ ÑĞµÑÑĞ¸Ğ¸ (Ğ½Ğ¾Ğ²Ñ‹Ğ¹ Ñ„Ğ°Ğ¹Ğ» Ğ½Ğ° ĞºĞ°Ğ¶Ğ´Ğ¾Ğµ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ)
- Ğ ÑƒÑ‡Ğ½Ğ¾Ğ¼ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞµ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ

**Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ»Ğ¾Ğ³-Ñ„Ğ°Ğ¹Ğ»Ğ°:**

```
# NeuroComm DemoBox Log File
# Generated: 2026-02-12 14:52:33
# Device: 336234593133
# Firmware: MCU1 v1.5.0, MCU2 v1.2.0-rc8, MCU3 v1.1.0-rc12
# Mode: AI-VOX PRO + SR
# Protocol Version: 2.0
#
# Format: [timestamp] [severity] [source] message
#
[2026-02-12 14:52:33.185] [INFO] [App] Application started
[2026-02-12 14:52:33.201] [INFO] [App] Scanning for devices...
[2026-02-12 14:52:34.103] [INFO] [Device] Found device: 336234593133
[2026-02-12 14:52:34.550] [INFO] [Device] Handshake completed
[2026-02-12 14:52:34.551] [INFO] [MCU2] Current mode: AI-VOX PRO + SR
[2026-02-12 14:52:35.102] [DEBUG] [MCU1] VAD threshold: 0.55
[2026-02-12 14:52:35.103] [DEBUG] [MCU1] Start marker size: 4
...
```

**Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ñ‹:**

1. **Plain text (.log)** â€” ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ (ĞºĞ°Ğº Ğ²Ñ‹ÑˆĞµ)
2. **CSV (.csv)** â€” Ğ´Ğ»Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° Ğ² Excel/Python:
   ```csv
   timestamp,severity,source,message
   2026-02-12 14:52:33.185,INFO,App,Application started
   2026-02-12 14:52:33.201,INFO,App,Scanning for devices...
   ```
3. **JSON (.json)** â€” ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ½Ğ¾Ğ³Ğ¾ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°:
   ```json
   {
     "session_id": "336234593133_20260212_145233",
     "start_time": "2026-02-12T14:52:33Z",
     "end_time": "2026-02-12T15:23:45Z",
     "device_info": { ... },
     "events": [
       {
         "timestamp": "2026-02-12T14:52:33.185Z",
         "severity": "INFO",
         "source": "App",
         "message": "Application started"
       },
       ...
     ]
   }
   ```
4. **HTML (.html)** â€” Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€Ğ° Ğ² Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğµ Ñ Ñ†Ğ²ĞµÑ‚Ğ¾Ğ²Ñ‹Ğ¼ ĞºĞ¾Ğ´Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼ Ğ¸ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸ĞµĞ¹

**UI Ğ´Ğ»Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ»Ğ¾Ğ³Ğ°Ğ¼Ğ¸:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Log File Management                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Current session log:                        â”‚
â”‚ neurocomm_log_20260212_145233_33623.log     â”‚
â”‚ Size: 15.3 MB | Duration: 00:31:12          â”‚
â”‚                                             â”‚
â”‚ [Save As...] [Export...] [Settings]        â”‚
â”‚                                             â”‚
â”‚ â”€â”€â”€ Log History â”€â”€â”€                         â”‚
â”‚                                             â”‚
â”‚ ğŸ“„ 20260212_145233 (15.3 MB) - Active      â”‚
â”‚ ğŸ“„ 20260212_121045 (48.2 MB)               â”‚
â”‚ ğŸ“¦ 20260211_160234 (45.1 MB) - compressed  â”‚
â”‚ ğŸ“¦ 20260211_093312 (52.7 MB) - compressed  â”‚
â”‚ ...                                         â”‚
â”‚                                             â”‚
â”‚ Total: 8 files, 421.5 MB                    â”‚
â”‚ [Open] [Export] [Delete] [Compress All]    â”‚
â”‚                                             â”‚
â”‚ â”€â”€â”€ Settings â”€â”€â”€                            â”‚
â”‚ Max file size:     [50] MB                  â”‚
â”‚ Max files:         [100]                    â”‚
â”‚ Retention period:  [30] days                â”‚
â”‚ Auto-compress:     [âœ“] after 7 days         â”‚
â”‚ Auto-delete:       [âœ“] after 30 days        â”‚
â”‚                                             â”‚
â”‚ Log directory:                              â”‚
â”‚ C:\Users\...\AppData\NeuroComm\logs\        â”‚
â”‚ [Change...] [Open Folder]                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ĞŸĞ¾Ğ¸ÑĞº Ğ¿Ğ¾ Ğ°Ñ€Ñ…Ğ¸Ğ²Ğ½Ñ‹Ğ¼ Ğ»Ğ¾Ğ³Ğ°Ğ¼:**
- Full-text search Ğ¿Ğ¾ Ğ²ÑĞµĞ¼ ÑĞ¾Ñ…Ñ€Ğ°Ğ½Ñ‘Ğ½Ğ½Ñ‹Ğ¼ Ğ»Ğ¾Ğ³Ğ°Ğ¼
- Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ğ¾ Ğ´Ğ°Ñ‚Ğµ/Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸, severity, source
- Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ Ğ¿Ğ¾Ğ¸ÑĞº Ğ¿Ğ¾ session_id Ğ¸Ğ»Ğ¸ device serial
- Regex Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° Ğ´Ğ»Ñ ÑĞ»Ğ¾Ğ¶Ğ½Ñ‹Ñ… Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²

**ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ²ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:**
- ĞŸÑ€Ğ¸ ÑÑ‚Ğ°Ñ€Ñ‚Ğµ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ: Ğ½Ğ¾Ğ²Ñ‹Ğ¹ Ğ»Ğ¾Ğ³-Ñ„Ğ°Ğ¹Ğ»
- ĞŸÑ€Ğ¸ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¸ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ°: Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ device info Ğ² header
- ĞŸÑ€Ğ¸ ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… Ğ¾ÑˆĞ¸Ğ±ĞºĞ°Ñ…: Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ flush buffer Ğ½Ğ° Ğ´Ğ¸ÑĞº
- ĞŸÑ€Ğ¸ Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚Ğ¸Ğ¸ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ: Ñ„Ğ¸Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ»Ğ¾Ğ³-Ñ„Ğ°Ğ¹Ğ»Ğ° Ñ summary

**Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ offline analysis:**
- Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ° Ğ»Ğ¾Ğ³-Ñ„Ğ°Ğ¹Ğ»Ğ° Ğ² replay mode
- ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ ÑĞ²ÑĞ·Ñ‹Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ»Ğ¾Ğ³Ğ° Ñ Ğ°ÑƒĞ´Ğ¸Ğ¾-Ğ·Ğ°Ğ¿Ğ¸ÑÑĞ¼Ğ¸ (ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ)
- Export ÑĞ²ÑĞ·ĞºĞ¸ log+audio Ğ² ĞµĞ´Ğ¸Ğ½Ñ‹Ğ¹ Ğ°Ñ€Ñ…Ğ¸Ğ² Ğ´Ğ»Ñ Ğ¿ĞµÑ€ĞµĞ´Ğ°Ñ‡Ğ¸ ĞºĞ¾Ğ»Ğ»ĞµĞ³Ğ°Ğ¼

---


#### 3.12.5 Logging Implementation Details

**Logging Framework:**

Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ğ¹ Python `logging` module Ñ custom handlers:

```python
import logging
from logging.handlers import RotatingFileHandler
import gzip
import shutil
from pathlib import Path
from datetime import datetime

class CompressedRotatingFileHandler(RotatingFileHandler):
    """Custom handler with gzip compression of rotated logs"""
    
    def doRollover(self):
        # Rotate file
        super().doRollover()
        
        # Compress rotated file
        rotated_file = f"{self.baseFilename}.1"
        if Path(rotated_file).exists():
            with open(rotated_file, 'rb') as f_in:
                with gzip.open(f"{rotated_file}.gz", 'wb') as f_out:
                    shutil.copyfileobj(f_in, f_out)
            Path(rotated_file).unlink()

# Setup logging
log_dir = Path.home() / ".config" / "neurocomm" / "logs"
log_dir.mkdir(parents=True, exist_ok=True)

log_file = log_dir / f"neurocomm_log_{datetime.now():%Y%m%d_%H%M%S}.log"

handler = CompressedRotatingFileHandler(
    log_file,
    maxBytes=50 * 1024 * 1024,  # 50 MB
    backupCount=100
)

formatter = logging.Formatter(
    '[%(asctime)s] [%(levelname)s] [%(name)s] %(message)s',
    datefmt='%Y-%m-%d %H:%M:%S.%f'
)
handler.setFormatter(formatter)

logger = logging.getLogger("neurocomm")
logger.addHandler(handler)
logger.setLevel(logging.DEBUG)

# Usage
logger.info("Application started")
logger.debug("VAD threshold set to 0.55")
logger.error("Connection lost", exc_info=True)
```

**Log Categories (Python logger names):**

```python
logger_app = logging.getLogger("neurocomm.app")          # Application events
logger_device = logging.getLogger("neurocomm.device")    # Device communication
logger_protocol = logging.getLogger("neurocomm.protocol") # Protocol messages
logger_mcu1 = logging.getLogger("neurocomm.mcu1")        # MCU1 events
logger_mcu2 = logging.getLogger("neurocomm.mcu2")        # MCU2 events
logger_ui = logging.getLogger("neurocomm.ui")            # UI events
```

**Structured Logging (JSON format option):**

```python
import json
from datetime import datetime

class JSONFormatter(logging.Formatter):
    def format(self, record):
        log_obj = {
            "timestamp": datetime.fromtimestamp(record.created).isoformat(),
            "level": record.levelname,
            "logger": record.name,
            "message": record.getMessage(),
            "module": record.module,
            "function": record.funcName,
            "line": record.lineno
        }
        
        if record.exc_info:
            log_obj["exception"] = self.formatException(record.exc_info)
        
        return json.dumps(log_obj)

# Use JSON formatter for structured logs
json_handler = RotatingFileHandler("neurocomm.json.log")
json_handler.setFormatter(JSONFormatter())
logger.addHandler(json_handler)
```

**Performance considerations:**
- Buffered writes (default in RotatingFileHandler)
- Async logging Ğ´Ğ»Ñ high-frequency events (using QueueHandler)
- Conditional debug logging (Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑƒÑ€Ğ¾Ğ²Ğ½Ñ Ğ¿ĞµÑ€ĞµĞ´ expensive formatting)

```python
# Efficient debug logging
if logger.isEnabledFor(logging.DEBUG):
    logger.debug(f"Expensive computation: {expensive_function()}")
```



## 4. ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ

### 4.1 Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ¾Ğ²

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           User Interface Layer                 â”‚
â”‚  (Qt/Electron/Native UI Framework)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         Application Logic Layer                â”‚
â”‚  - Device Manager                              â”‚
â”‚  - Configuration Manager                       â”‚
â”‚  - Log Manager                                 â”‚
â”‚  - Visualization Engine                        â”‚
â”‚  - Session Recorder                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚       Communication Protocol Layer             â”‚
â”‚  - USB CDC / UART Driver                       â”‚
â”‚  - Message Serialization (msgpack)             â”‚
â”‚  - Command Queue                               â”‚
â”‚  - Stream Manager                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              Hardware Layer                    â”‚
â”‚  USB â†’ MCU3 â†’ UART â†’ MCU2 â†” MCU1               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 ĞŸÑ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ» Ğ¾Ğ±Ğ¼ĞµĞ½Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸

**Ğ¤Ğ¸Ğ·Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ:**
- Desktop App â†” MCU3: USB CDC
- MCU3 â†” MCU2: UART 500k (ÑĞµÑ€Ğ²Ğ¸ÑĞ½Ñ‹Ğ¹ ĞºĞ°Ğ½Ğ°Ğ»)
- MCU2 â†” MCU1: UART 1M (Ğ°ÑƒĞ´Ğ¸Ğ¾ + control, ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡Ğ½Ñ‹Ğ¹)

**Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹:**
- Framing: `SOF (0xAA 0x55) | VER | TYPE | FLAGS | SEQ | LEN | PAYLOAD | CRC16`
- CRC: CRC-16/CCITT-FALSE (poly 0x1021, init 0xFFFF)
- Sequence numbering: modulo 256 Ğ´Ğ»Ñ Ğ´ĞµÑ‚ĞµĞºÑ†Ğ¸Ğ¸ Ğ¿Ğ¾Ñ‚ĞµÑ€ÑŒ
- Total overhead: 10 bytes per packet

**Ğ›Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ°ÑƒĞ´Ğ¸Ğ¾-Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ¸:**

| Stream ID | ĞĞ°Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Ğ£ÑĞ»Ğ¾Ğ²Ğ¸Ñ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ°Ñ†Ğ¸Ğ¸ |
|-----------|-------------|----------|-------------------|
| RX_STREAM_OUT | MCU1â†’MCU2 | Radio SPK â†’ Headset playback | RX Ñ€ĞµĞ¶Ğ¸Ğ¼, VE Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ |
| TX_AUDIO_OUT | MCU1â†’MCU2 | MIC â†’ Radio TX | PTT=ON, VE Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ |
| MIC_BYPASS | MCU1â†’MCU2 | Ğ¡Ñ‹Ñ€Ğ¾Ğ¹ MIC (Ğ´Ğ¾ VE) | Ğ”Ğ»Ñ KWS (Ğ¼Ğ°ĞºÑ. ÑÑ‚Ğ°Ğ±Ğ¸Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ) |
| MIC_VE | MCU1â†’MCU2 | MIC Ğ¿Ğ¾ÑĞ»Ğµ VE | Ğ”Ğ»Ñ KWS Ğ² Ñ€ĞµĞ¶Ğ¸Ğ¼Ğµ VE_always_on |

**ĞĞ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ñ Ğ¿Ğ¾Ğ»Ğ¾ÑÑ‹ UART:**
- ĞŸÑ€Ğ¸ 500k baud (MCU3â†”MCU2): Ğ¼Ğ°ĞºÑĞ¸Ğ¼ÑƒĞ¼ 1 PCM Ğ¿Ğ¾Ñ‚Ğ¾Ğº + events
- ĞŸÑ€Ğ¸ 1M baud (MCU2â†”MCU1): Ğ´Ğ¾ 2 PCM Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ² Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ñ‹, Ğ½Ğ¾ Ñ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ĞµĞ¼ overhead
- ĞŸÑ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ¾Ñ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°Ñ‚ÑŒ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ¸ Ğ¸ Ğ¿Ñ€ĞµĞ´ÑƒĞ¿Ñ€ĞµĞ¶Ğ´Ğ°Ñ‚ÑŒ Ğ¾ Ğ¿ĞµÑ€ĞµĞ³Ñ€ÑƒĞ·ĞºĞµ ĞºĞ°Ğ½Ğ°Ğ»Ğ°

**ĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹:**

**1. Commands (App â†’ MCU2 â†’ MCU1):**
   - Core control:
     - `CMD_SET_MODE(mode, ptt)` where mode âˆˆ {RX, TX, STANDBY}
     - `CMD_GET_STATUS()`
     - `CMD_RESET_AUDIO_DOMAIN()`
   
   - VE/routing (MCU2â†’MCU1):
     - `SET_VE_MODE(mode)` where mode âˆˆ {DISABLED, ENABLED, ALWAYS_ON}
     - `SET_VE_ENABLE(rx_enable, tx_enable)`
     - `SET_STREAM_ENABLE(stream_id, enable)`
   
   - PTT gate:
     - `PTT_STATE(ON|OFF)` (Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ñ‡ĞµÑ€ĞµĞ· MCU2 state machine)
   
   - VAD:
     - `SET_VAD_CONFIG(chunk_ms, process_ms, skip_ms)`
     - `SET_VAD_MARKERS(N_start, M_stop)`
   
   - KWS audio source:
     - `SET_KWS_AUDIO_SOURCE(src)` where src âˆˆ {MIC_BYPASS, MIC_VE}

**2. Events (MCU1 â†’ MCU2 â†’ App):**
   - VAD events:
     - `EVT_VAD(flag, chunk_id, start_cnt, stop_cnt)`
   - System status:
     - `STATUS(rx_active, tx_active, ve_mode, ve_rx_en, ve_tx_en, active_streams, levels, faults)`
   - Faults:
     - `EVT_FAULT(code, details)`

**3. State machine events (MCU2 â†’ App):**
   - KWS: `CMD_DETECTED(cmd_id)` where cmd_id âˆˆ {1,2,3,4}
   - SR: `SR_CONFIRMED` | `SR_REJECTED`
   - Session: `SESSION_ACTIVE` | `SESSION_CLOSED` | `SESSION_TIMEOUT`
   - PTT: `PTT_ON` | `PTT_OFF`

**4. Audio frames (MCU1 â†’ MCU2 â†’ App):**
   - `AUDIO_FRAME(stream_id, chunk_id, pcm_payload)`
   - PCM format: 16 kHz, 16-bit signed, mono, little-endian
   - Chunk size: typically 16 ms (256 samples = 512 bytes)

> **Ğ’ĞĞ–ĞĞ:** KWS/SR ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒÑÑ‚ÑÑ Ğ½Ğ° MCU2 (Ğ½Ğµ Ğ½Ğ° MCU1) Ğ¸ Ğ¿ĞµÑ€ĞµĞ´Ğ°ÑÑ‚ÑÑ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ Ñ‡ĞµÑ€ĞµĞ· MCU3.

---

### 4.3 Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸ĞµĞ¼

**Application State:**
- Connection status (Disconnected / Connected / Reconnecting / Error)
- Device state (Idle / Running / Flashing / Recording)
- Current configuration (Ğ²ÑĞµÑ… Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ²)
- UI state (Ğ²Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ½Ñ‹Ğµ Ñ‚Ğ°Ğ±Ñ‹, Ñ„Ğ»Ğ°Ğ³Ğ¸, Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ñ‹)
- Active streams (ĞºĞ°ĞºĞ¸Ğµ Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ¸ Ğ²ĞºĞ»ÑÑ‡ĞµĞ½Ñ‹)
- Session info (start time, duration, events count)

**State synchronization:**
- ĞŸÑ€Ğ¸ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¸ â€” Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ Ñ‚ĞµĞºÑƒÑ‰Ğ¸Ñ… Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ² ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ° (GET_STATUS + GET_PARAMS)
- ĞŸÑ€Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¸ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ² Ğ² UI â†’ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ğ½Ğ° ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ¾ â†’ Ğ¾Ğ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ğµ ACK
- ĞŸÑ€Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğ¸ Ğ½Ğ¾Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¹ Ğ¾Ñ‚ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ° â†’ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ UI
- ĞŸÑ€Ğ¸ reconnect â€” conflict resolution (device state vs app state)

**State persistence:**
- Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ UI state Ğ¼ĞµĞ¶Ğ´Ñƒ ÑĞµĞ°Ğ½ÑĞ°Ğ¼Ğ¸ (window position, active tabs, filters)
- Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½ĞµĞ¹ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ° (Ğ¿Ğ¾ serial number)
- Auto-restore Ğ¿Ñ€Ğ¸ reconnect Ğº Ğ¸Ğ·Ğ²ĞµÑÑ‚Ğ½Ğ¾Ğ¼Ñƒ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ñƒ

---

### 4.4 ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº

**Ğ¢Ğ¸Ğ¿Ñ‹ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº:**
1. **Connection errors** â€” Ğ¿Ğ¾Ñ‚ĞµÑ€Ñ ÑĞ²ÑĞ·Ğ¸, Ñ‚Ğ°Ğ¹Ğ¼Ğ°ÑƒÑ‚, device not found
2. **Protocol errors** â€” Ğ½ĞµĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ, checksum mismatch, sequence gap
3. **Device errors** â€” firmware error, algorithm failure, buffer overflow
4. **User errors** â€” Ğ½ĞµĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ñ‹Ğµ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹, Ğ½ĞµÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ğ°Ñ Ğ¿Ñ€Ğ¾ÑˆĞ¸Ğ²ĞºĞ°, Ğ½ĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸

**Ğ¡Ñ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ğ¸:**
- ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¿ĞµÑ€ĞµĞ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸ Ğ¿Ğ¾Ñ‚ĞµÑ€Ğµ ÑĞ²ÑĞ·Ğ¸ (3 Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚ĞºĞ¸ Ñ Ğ¸Ğ½Ñ‚ĞµÑ€Ğ²Ğ°Ğ»Ğ¾Ğ¼ 1 ÑĞµĞº)
- ĞÑ‚ĞºĞ°Ñ‚ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ² Ğ¿Ñ€Ğ¸ Ğ¾ÑˆĞ¸Ğ±ĞºĞµ Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ (rollback to last known good state)
- ĞÑ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ñ… ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹ Ğ¾Ğ± Ğ¾ÑˆĞ¸Ğ±ĞºĞ°Ñ… Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ (Ñ actionable suggestions)
- Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ²ÑĞµÑ… Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº Ñ full context (state snapshot)

**Error recovery:**
- Connection lost â†’ auto-reconnect â†’ full handshake â†’ state resync
- Protocol error â†’ resync framing â†’ request retransmit (if applicable)
- Device error â†’ display error â†’ suggest reset / reflash / contact support
- User error â†’ validation before send â†’ clear feedback â†’ block invalid input

**Error notification UI:**
- Toast notifications Ğ´Ğ»Ñ Ğ½ĞµĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº (auto-dismiss)
- Modal dialogs Ğ´Ğ»Ñ ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº (Ñ‚Ñ€ĞµĞ±ÑƒÑÑ‚ action)
- Error panel Ğ² ÑÑ‚Ğ°Ñ‚ÑƒÑ-Ğ±Ğ°Ñ€Ğµ (persistent indicator)
- Detailed error log Ğ² Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ğ¾Ğ¼ Ğ¾ĞºĞ½Ğµ (Ğ´Ğ»Ñ troubleshooting)

---

### 4.5 Stream Manager

**Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¸:**
- Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¼Ğ¸ Ğ°ÑƒĞ´Ğ¸Ğ¾-Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ°Ğ¼Ğ¸
- ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ bandwidth usage
- ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚Ğ°Ğ¼Ğ¸ Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ²
- Ğ‘ÑƒÑ„ĞµÑ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¸ ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ

**Bandwidth monitoring:**
```
Current UART load (MCU2â†”MCU3 @ 500k):
- RX_STREAM_OUT: 256 kbps (51%)
- Events/Control: 24 kbps (5%)
- Total: 280 kbps / 500 kbps (56%)
- Headroom: 220 kbps (44%)
```

**Stream priority:**
1. Control messages (highest priority)
2. TX_AUDIO_OUT (when PTT=ON)
3. RX_STREAM_OUT (RX playback)
4. MIC_BYPASS / MIC_VE (KWS input)
5. Debug telemetry (lowest priority)

**Auto-management:**
- ĞŸÑ€Ğ¸ ÑƒĞ³Ñ€Ğ¾Ğ·Ğµ Ğ¿ĞµÑ€ĞµĞ³Ñ€ÑƒĞ·ĞºĞ¸: Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¾Ñ‚ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ½Ğ¸Ğ·ĞºĞ¾Ğ¿Ñ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚Ğ½Ñ‹Ñ… Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ²
- ĞŸÑ€ĞµĞ´ÑƒĞ¿Ñ€ĞµĞ¶Ğ´ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ Ğ¿ĞµÑ€ĞµĞ´ Ğ¾Ñ‚ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸ĞµĞ¼
- Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ Ñ€ÑƒÑ‡Ğ½Ğ¾Ğ³Ğ¾ override (force enable)

---



### 4.6 Threading Model

**ĞœĞ½Ğ¾Ğ³Ğ¾Ğ¿Ğ¾Ñ‚Ğ¾Ñ‡Ğ½Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ´Ğ»Ñ responsiveness:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Main Thread (UI)                    â”‚
â”‚  - Qt/QML Event Loop                        â”‚
â”‚  - User Interaction                         â”‚
â”‚  - Rendering                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ Signals/Events
               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Communication Thread                â”‚
â”‚  - USB read (blocking)                      â”‚
â”‚  - USB write (queued)                       â”‚
â”‚  - Protocol parsing                         â”‚
â”‚  - CRC verification                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ Message Queue
               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Processing Thread                   â”‚
â”‚  - Telemetry collection                     â”‚
â”‚  - State machine updates                    â”‚
â”‚  - Audio decoding (LC3)                     â”‚
â”‚  - Event aggregation                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ Processed Data
               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Logging Thread                      â”‚
â”‚  - Log writing (buffered)                   â”‚
â”‚  - Log rotation                             â”‚
â”‚  - Compression (background)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Thread Safety:**

- **Qt Signals/Slots:** Ğ´Ğ»Ñ communication Ğ¼ĞµĞ¶Ğ´Ñƒ threads (thread-safe by design)
- **Thread-safe queues:** `queue.Queue` Ğ´Ğ»Ñ message passing
- **Locks:** minimal use, prefer message passing architecture
- **Immutable data:** Ğ¿ĞµÑ€ĞµĞ´Ğ°Ğ²Ğ°Ñ‚ÑŒ ĞºĞ¾Ğ¿Ğ¸Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¼ĞµĞ¶Ğ´Ñƒ threads Ğ³Ğ´Ğµ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾

**Example implementation:**

```python
from PySide6.QtCore import QThread, Signal
import queue

class CommunicationThread(QThread):
    """Thread for USB communication"""
    message_received = Signal(dict)  # Qt Signal (thread-safe)
    connection_lost = Signal()
    
    def __init__(self, device):
        super().__init__()
        self.device = device
        self.running = True
        self.write_queue = queue.Queue()
    
    def run(self):
        """Main thread loop"""
        while self.running:
            # Non-blocking write
            try:
                message = self.write_queue.get_nowait()
                self.device.write(message)
            except queue.Empty:
                pass
            
            # Blocking read with timeout
            try:
                data = self.device.read(timeout=0.1)
                if data:
                    message = self.parse_message(data)
                    self.message_received.emit(message)  # Send to main thread
            except TimeoutError:
                continue
            except Exception as e:
                self.connection_lost.emit()
                break
    
    def send_message(self, message):
        """Called from main thread to queue message"""
        self.write_queue.put(message)
    
    def stop(self):
        """Stop thread gracefully"""
        self.running = False
        self.wait()  # Wait for thread to finish

# Usage in main thread
comm_thread = CommunicationThread(device)
comm_thread.message_received.connect(self.on_message_received)
comm_thread.connection_lost.connect(self.on_connection_lost)
comm_thread.start()

# Send message (non-blocking from UI thread)
comm_thread.send_message({"type": "CMD_START"})
```

**Performance benefits:**
- UI remains responsive Ğ´Ğ°Ğ¶Ğµ Ğ¿Ñ€Ğ¸ intensive communication
- No blocking operations Ğ² main thread
- Background processing Ğ½Ğµ Ğ²Ğ»Ğ¸ÑĞµÑ‚ Ğ½Ğ° rendering
- Smooth animations and user interaction

**Guidelines:**
- Ğ’ÑĞµĞ³Ğ´Ğ° use Qt Signals Ğ´Ğ»Ñ communication UI â†” threads
- Never call UI methods directly from worker threads
- Keep thread functions simple and focused
- Handle thread termination gracefully (stop flags, not force kill)


## 5. User Interface Requirements

### 5.1 ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ ÑĞºÑ€Ğ°Ğ½Ñ‹/Ñ‚Ğ°Ğ±Ñ‹

1. **Neurocomm** (Ğ³Ğ»Ğ°Ğ²Ğ½Ğ°Ñ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ°)
   - Ğ‘Ğ»Ğ¾Ğº Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ°
   - ĞŸĞ°Ğ½ĞµĞ»ÑŒ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ·Ğ°Ğ¿Ğ¸ÑÑŒÑ (Start/Stop/Set params)
   - Ğ‘Ğ»Ğ¾ĞºĞ¸ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ²: Neurocomm params, Input params, VAD params, VE params, Output params, Sensory params
   - Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº debug flags (Ñ Ğ³Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²ĞºĞ¾Ğ¹)
   - Ğ›Ğ¾Ğ³-Ğ¾ĞºĞ½Ğ¾ (real-time)
   - Status panel (device state, firmware versions)

2. **Monitoring** (Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ğ¸ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ)
   - State machine diagram
   - VAD map visualization
   - KWS/SR monitoring
   - Audio streams monitoring
   - Real-time graphs (RMS, levels)

3. **Recording** (offline analysis)
   - Recording controls (start/stop/pause)
   - Active recording indicator
   - Storage space indicator
   - Recorded sessions list
   - Replay interface

4. **Firmware Update**
   - Ğ’Ñ‹Ğ±Ğ¾Ñ€ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¸ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ°
   - Sync Ğ¸ Flash Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸
   - ĞŸÑ€Ğ¾Ğ³Ñ€ĞµÑÑ Ğ¿Ñ€Ğ¾ÑˆĞ¸Ğ²ĞºĞ¸
   - Verification status

5. **Settings**
   - Log file management
   - UI preferences
   - Debug options
   - About / Help

### 5.2 UI/UX Ğ¿Ñ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿Ñ‹

- **ĞŸÑ€Ğ¾ÑÑ‚Ğ¾Ñ‚Ğ°:** ĞœĞ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»Ğ¸ÑÑ‚Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ, Ñ„Ğ¾ĞºÑƒÑ Ğ½Ğ° Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸
- **Ğ¯ÑĞ½Ğ¾ÑÑ‚ÑŒ:** ĞŸĞ¾Ğ½ÑÑ‚Ğ½Ñ‹Ğµ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ², Ğ¿Ğ¾Ğ´ÑĞºĞ°Ğ·ĞºĞ¸ Ğ¿Ñ€Ğ¸ Ğ½Ğ°Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğ¸ (tooltips)
- **ĞÑ‚Ğ·Ñ‹Ğ²Ñ‡Ğ¸Ğ²Ğ¾ÑÑ‚ÑŒ:** Ğ ĞµĞ°ĞºÑ†Ğ¸Ñ Ğ½Ğ° Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ < 100 Ğ¼Ñ (ÑĞ¿Ğ¸Ğ½Ğ½ĞµÑ€Ñ‹, Ğ¸Ğ½Ğ´Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€Ñ‹)
- **Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¸ĞµÑ€Ğ°Ñ€Ñ…Ğ¸Ñ:** Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° ÑĞ²ÑĞ·Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ² Ğ² Ğ±Ğ»Ğ¾ĞºĞ¸ (collapsible)
- **Ğ¡Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ:** Ğ§ĞµÑ‚ĞºĞ°Ñ Ğ¸Ğ½Ğ´Ğ¸ĞºĞ°Ñ†Ğ¸Ñ Ñ‚ĞµĞºÑƒÑ‰ĞµĞ³Ğ¾ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ° Ğ¸ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ
- **Feedback:** ĞĞµĞ¼ĞµĞ´Ğ»ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ feedback Ğ½Ğ° ĞºĞ°Ğ¶Ğ´Ğ¾Ğµ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ
- **Consistency:** Ğ•Ğ´Ğ¸Ğ½Ñ‹Ğ¹ ÑÑ‚Ğ¸Ğ»ÑŒ Ğ´Ğ»Ñ Ğ²ÑĞµÑ… ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ¾Ğ² (colors, fonts, icons)
- **Accessibility:** ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° keyboard navigation, screen readers (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)

### 5.3 Ğ­Ğ»ĞµĞ¼ĞµĞ½Ñ‚Ñ‹ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑĞ°

- **Dropdowns** â€” Ğ´Ğ»Ñ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ° Ñ€ĞµĞ¶Ğ¸Ğ¼Ğ¾Ğ², ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ², ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¹
- **Numeric inputs** â€” Ğ´Ğ»Ñ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ² Ñ Ñ‡Ğ¸ÑĞ»Ğ¾Ğ²Ñ‹Ğ¼Ğ¸ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸ÑĞ¼Ğ¸ (Ñ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸ĞµĞ¹ Ğ´Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½Ğ°, step controls)
- **Checkboxes** â€” Ğ´Ğ»Ñ debug flags, boolean options
- **Radio buttons** â€” Ğ´Ğ»Ñ Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ¸ÑĞºĞ»ÑÑ‡Ğ°ÑÑ‰Ğ¸Ñ… Ğ¾Ğ¿Ñ†Ğ¸Ğ¹ (mode selection)
- **Sliders** â€” Ğ´Ğ»Ñ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ² Ñ Ğ½ĞµĞ¿Ñ€ĞµÑ€Ñ‹Ğ²Ğ½Ñ‹Ğ¼Ğ¸ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸ÑĞ¼Ğ¸ (gain, threshold)
- **Buttons** â€” Ğ´Ğ»Ñ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´ (Connect, Start, Stop, Flash) Ñ clear labels
- **Log panel** â€” Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹ Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ (virtualized scrolling)
- **Status bar** â€” Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ñ Ğ¸ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ° (always visible)
- **Progress bars** â€” Ğ´Ğ»Ñ Ğ´Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ñ… Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹ (firmware update, recording)
- **Tabs** â€” Ğ´Ğ»Ñ Ğ½Ğ°Ğ²Ğ¸Ğ³Ğ°Ñ†Ğ¸Ğ¸ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğ¼Ğ¸ Ñ€Ğ°Ğ·Ğ´ĞµĞ»Ğ°Ğ¼Ğ¸
- **Modals** â€” Ğ´Ğ»Ñ ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğ¹ (confirmation dialogs)
- **Tooltips** â€” Ğ´Ğ»Ñ Ğ´Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğ¹ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¸ Ğ¾ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ°Ñ…

**Color scheme:**
- Success: Ğ·ĞµĞ»ĞµĞ½Ñ‹Ğ¹ (#4CAF50)
- Warning: Ğ¾Ñ€Ğ°Ğ½Ğ¶ĞµĞ²Ñ‹Ğ¹ (#FF9800)
- Error: ĞºÑ€Ğ°ÑĞ½Ñ‹Ğ¹ (#F44336)
- Info: ÑĞ¸Ğ½Ğ¸Ğ¹ (#2196F3)
- Neutral: ÑĞµÑ€Ñ‹Ğ¹ (#9E9E9E)

---

## 6. ĞĞµÑ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

### 6.1 ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ

**ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹:**
- ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ²Ñ…Ğ¾Ğ´ÑÑ‰Ğ¸Ñ… ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹ Ğ¾Ñ‚ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ° Ğ±ĞµĞ· Ğ·Ğ°Ğ´ĞµÑ€Ğ¶ĞµĞº (< 10 Ğ¼Ñ)
- ĞÑ‚ĞºĞ»Ğ¸Ğº UI Ğ½Ğ° Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ < 100 Ğ¼Ñ
- ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° Ğ²Ñ‹ÑĞ¾ĞºĞ¾Ñ‡Ğ°ÑÑ‚Ğ¾Ñ‚Ğ½Ñ‹Ñ… debug-Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ²:
  - VAD map: ĞºĞ°Ğ¶Ğ´Ñ‹Ğµ 16 Ğ¼Ñ (62.5 Hz)
  - Audio frames: 16 kHz Ã— 16 bit = 256 kbps per stream
  - Events: Ğ´Ğ¾ 100 events/sec Ğ² Ğ¿Ğ¸ĞºĞ¾Ğ²Ñ‹Ñ… Ñ€ĞµĞ¶Ğ¸Ğ¼Ğ°Ñ…

**Ğ‘ÑƒÑ„ĞµÑ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ:**
- Ring buffer Ğ´Ğ»Ñ incoming events: Ğ¼Ğ¸Ğ½Ğ¸Ğ¼ÑƒĞ¼ 1000 ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹
- Audio frame buffer: Ğ¼Ğ¸Ğ½Ğ¸Ğ¼ÑƒĞ¼ 500 ms Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ°
- Log buffer: Ğ¼Ğ¸Ğ½Ğ¸Ğ¼ÑƒĞ¼ 10000 ÑÑ‚Ñ€Ğ¾Ğº Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ¹ Ğ¾Ñ‡Ğ¸ÑÑ‚ĞºĞ¾Ğ¹ ÑÑ‚Ğ°Ñ€Ñ‹Ñ…

**Memory footprint:**
- Ğ‘Ğ°Ğ·Ğ¾Ğ²Ğ°Ñ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ: < 100 MB RAM
- Ğ¡ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¼Ğ¸ debug streams: < 500 MB RAM
- Audio recording (offline analysis): < 2 GB RAM Ğ´Ğ»Ñ 1 Ñ‡Ğ°ÑĞ° Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸

**CPU usage:**
- Idle (Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ connection monitoring): < 5%
- Active monitoring (events + VAD map): < 15%
- Full debug (Ğ²ÑĞµ streams + visualization): < 40%

**Disk I/O:**
- Log writes: Ğ°ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ½Ñ‹Ğµ, buffered
- Audio recording: Ğ¿Ñ€ÑĞ¼Ğ°Ñ Ğ·Ğ°Ğ¿Ğ¸ÑÑŒ Ğ² Ñ„Ğ°Ğ¹Ğ» (Ğ±ĞµĞ· Ğ¿Ñ€Ğ¾Ğ¼ĞµĞ¶ÑƒÑ‚Ğ¾Ñ‡Ğ½Ğ¾Ğ³Ğ¾ Ğ±ÑƒÑ„ĞµÑ€Ğ°)
- Configuration save/load: < 100 ms

### 6.2 ĞĞ°Ğ´ĞµĞ¶Ğ½Ğ¾ÑÑ‚ÑŒ

- Ğ£ÑÑ‚Ğ¾Ğ¹Ñ‡Ğ¸Ğ²Ğ¾ÑÑ‚ÑŒ Ğº Ğ¿Ğ¾Ñ‚ĞµÑ€Ğµ ÑĞ²ÑĞ·Ğ¸ Ñ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ¾Ğ¼ (auto-reconnect)
- ĞšĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ°Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ½ĞµĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ñ‹Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¾Ñ‚ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ° (validation, sanitization)
- Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ Ğ¿Ñ€Ğ¸ Ğ½ĞµĞ¾Ğ¶Ğ¸Ğ´Ğ°Ğ½Ğ½Ğ¾Ğ¼ Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚Ğ¸Ğ¸ (crash recovery)
- Graceful degradation Ğ¿Ñ€Ğ¸ Ğ¾ÑˆĞ¸Ğ±ĞºĞ°Ñ… (Ğ¿Ñ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½Ğ¸Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ Ñ Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ½Ğ¾Ğ¹ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒÑ)
- Data integrity Ğ´Ğ»Ñ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¹ Ğ¸ Ğ»Ğ¾Ğ³Ğ¾Ğ² (checksums, atomic writes)

**MTBF (Mean Time Between Failures):**
- Ğ¦ĞµĞ»ĞµĞ²Ğ¾Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ: > 100 Ñ‡Ğ°ÑĞ¾Ğ² Ğ½ĞµĞ¿Ñ€ĞµÑ€Ñ‹Ğ²Ğ½Ğ¾Ğ¹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹
- ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ memory leaks (valgrind, sanitizers)
- Stress testing Ñ Ğ¼Ğ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ½Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¾Ğ¹ (all streams active)

### 6.3 Ğ Ğ°ÑÑˆĞ¸Ñ€ÑĞµĞ¼Ğ¾ÑÑ‚ÑŒ

- ĞœĞ¾Ğ´ÑƒĞ»ÑŒĞ½Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ´Ğ»Ñ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ½Ğ¾Ğ²Ñ‹Ñ… Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¹ (plugin system Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)
- ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° Ğ½Ğ¾Ğ²Ñ‹Ñ… Ğ²ĞµÑ€ÑĞ¸Ğ¹ Ğ¿Ñ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ»Ğ° Ğ¾Ğ±Ğ¼ĞµĞ½Ğ° (protocol version negotiation)
- Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ½Ğ¾Ğ²Ñ‹Ñ… Ñ€ĞµĞ¶Ğ¸Ğ¼Ğ¾Ğ² Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ° (configuration-driven)
- Extensible logging framework (custom log handlers)
- API Ğ´Ğ»Ñ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ñ Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ğ¼Ğ¸ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸ (CLI, REST API Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)

### 6.4 Ğ¢ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµĞ¼Ğ¾ÑÑ‚ÑŒ

- Unit-Ñ‚ĞµÑÑ‚Ñ‹ Ğ´Ğ»Ñ Ğ±Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ¸ (coverage > 80%)
- ĞœĞ¾Ğº-ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ¾ Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ UI Ğ±ĞµĞ· Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ hardware (device simulator)
- Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ²ÑĞµÑ… ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹ Ğ´Ğ»Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° (comprehensive logging)
- Integration tests Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ»Ğ° Ğ¾Ğ±Ğ¼ĞµĞ½Ğ° (roundtrip tests)
- UI tests Ğ´Ğ»Ñ ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡Ğ½Ñ‹Ñ… workflows (automated UI testing)

### 6.5 Usability

- Onboarding Ğ´Ğ»Ñ Ğ½Ğ¾Ğ²Ñ‹Ñ… Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹ (first-run wizard)
- Contextual help (tooltips, inline documentation)
- Keyboard shortcuts Ğ´Ğ»Ñ Ñ‡Ğ°ÑÑ‚Ñ‹Ñ… Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹ (Ctrl+S Ğ´Ğ»Ñ save, F5 Ğ´Ğ»Ñ refresh)
- Undo/Redo Ğ´Ğ»Ñ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ² (Ğ³Ğ´Ğµ Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½Ğ¸Ğ¼Ğ¾)
- Recent devices list (Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾Ğµ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğº Ğ¸Ğ·Ğ²ĞµÑÑ‚Ğ½Ñ‹Ğ¼ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ°Ğ¼)

### 6.6 Security

- Validation Ğ²ÑĞµÑ… Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒÑĞºĞ¸Ñ… Ğ²Ğ²Ğ¾Ğ´Ğ¾Ğ² (Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ injection)
- Firmware signature verification (ĞµÑĞ»Ğ¸ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµÑ‚ÑÑ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ¾Ğ¼)
- Secure storage Ğ´Ğ»Ñ sensitive data (API keys, ĞµÑĞ»Ğ¸ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑÑ‚ÑÑ)
- No elevation required Ğ´Ğ»Ñ normal operation (user-level permissions)

---

## 7. Ğ¢ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ ÑÑ‚ĞµĞº (Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ğ¸)

### 7.1 Frontend

**Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ 1: Qt/C++ (Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ Ğ´Ğ»Ñ production)**
- âœ… ĞĞ°Ñ‚Ğ¸Ğ²Ğ½Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ
- âœ… ĞÑ‚Ğ»Ğ¸Ñ‡Ğ½Ğ°Ñ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° serial/USB ĞºĞ¾Ğ¼Ğ¼ÑƒĞ½Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸
- âœ… ĞŸÑ€Ğ¾Ñ„ĞµÑÑĞ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ²Ğ¸Ğ´
- âœ… ĞšÑ€Ğ¾ÑÑ-Ğ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ
- âœ… Ğ‘Ğ¾Ğ³Ğ°Ñ‚Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹ Ğ´Ğ»Ñ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ (Qt Charts, Qt Quick)
- âš ï¸ Ğ‘Ğ¾Ğ»ĞµĞµ ÑĞ»Ğ¾Ğ¶Ğ½Ğ°Ñ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° (C++ boilerplate)
- âš ï¸ Ğ¢Ñ€ĞµĞ±ÑƒĞµÑ‚ Qt Ğ»Ğ¸Ñ†ĞµĞ½Ğ·Ğ¸Ğ¸ Ğ´Ğ»Ñ ĞºĞ¾Ğ¼Ğ¼ĞµÑ€Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ (Ğ¸Ğ»Ğ¸ LGPL compliance)

**Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ 2: Electron + React/Vue (Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ Ğ´Ğ»Ñ MVP)**
- âœ… Ğ‘Ñ‹ÑÑ‚Ñ€Ğ°Ñ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°
- âœ… Ğ‘Ğ¾Ğ³Ğ°Ñ‚Ğ°Ñ ÑĞºĞ¾ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° UI ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ¾Ğ²
- âœ… ĞŸÑ€Ğ¾ÑÑ‚Ğ¾Ñ‚Ğ° Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ (JavaScript/TypeScript)
- âœ… Ğ’ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ½Ñ‹Ğµ dev tools
- âš ï¸ Ğ‘Ğ¾Ğ»ÑŒÑˆĞ¾Ğ¹ memory footprint (> 100 MB Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹)
- âš ï¸ ĞœĞµĞ´Ğ»ĞµĞ½Ğ½ĞµĞµ Qt Ğ´Ğ»Ñ high-frequency visualization

**Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ 3: Python + PyQt5/PyQt6**
- âœ… Ğ‘Ñ‹ÑÑ‚Ñ€Ğ°Ñ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°
- âœ… Ğ›ĞµĞ³ĞºĞ°Ñ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ Ğ¿Ñ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ»Ğ°Ğ¼Ğ¸ (pyserial)
- âœ… ĞÑ‚Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ñ‚Ğ¾Ñ‚Ğ¸Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
- âš ï¸ GIL Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ bottleneck Ğ´Ğ»Ñ multi-threading
- âš ï¸ Deployment ÑĞ»Ğ¾Ğ¶Ğ½ĞµĞµ (PyInstaller)



#### Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ñ Ğ´Ğ»Ñ Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ° Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸

Ğ”Ğ»Ñ Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾Ğ³Ğ¾ ÑÑ‚Ğ°Ñ€Ñ‚Ğ° Ğ¸ Ğ¿Ñ€Ğ¾Ñ‚Ğ¾Ñ‚Ğ¸Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ:

**PySide6 (Qt for Python) + QML:**
- âœ… Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ Ğ¼ĞµĞ¶Ğ´Ñƒ ÑĞºĞ¾Ñ€Ğ¾ÑÑ‚ÑŒÑ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ Ğ¸ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒÑ
- âœ… Ğ”ĞµĞºĞ»Ğ°Ñ€Ğ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ UI (QML) Ğ´Ğ»Ñ Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ¾Ñ‚Ğ¾Ñ‚Ğ¸Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
- âœ… Python backend Ğ´Ğ»Ñ Ğ»Ğ¾Ğ³Ğ¸ĞºĞ¸
- âœ… ĞĞ°Ñ‚Ğ¸Ğ²Ğ½Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ Qt Ğ¿Ğ¾Ğ´ ĞºĞ°Ğ¿Ğ¾Ñ‚Ğ¾Ğ¼
- âœ… ĞÑ‚Ğ»Ğ¸Ñ‡Ğ½Ğ°Ñ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ¸ community support
- âœ… ĞŸÑ€Ğ¾ÑÑ‚Ğ°Ñ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ pyserial, numpy, scipy
- âš ï¸ Ğ¢Ñ€ĞµĞ±ÑƒĞµÑ‚ Qt Ğ»Ğ¸Ñ†ĞµĞ½Ğ·Ğ¸Ğ¸ Ğ´Ğ»Ñ ĞºĞ¾Ğ¼Ğ¼ĞµÑ€Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ (LGPL Ğ¸Ğ»Ğ¸ commercial)

**Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°:**

```
src/
â”œâ”€â”€ ui/                    # QML files
â”‚   â”œâ”€â”€ main.qml
â”‚   â”œâ”€â”€ DevicePanel.qml
â”‚   â”œâ”€â”€ ConfigPanel.qml
â”‚   â””â”€â”€ MonitoringPanel.qml
â”œâ”€â”€ backend/               # Python backend
â”‚   â”œâ”€â”€ device_manager.py
â”‚   â”œâ”€â”€ protocol_handler.py
â”‚   â””â”€â”€ telemetry_collector.py
â””â”€â”€ main.py                # Qt Application entry point
```

**Example main.py:**

```python
import sys
from PySide6.QtWidgets import QApplication
from PySide6.QtQml import QQmlApplicationEngine
from backend.device_manager import DeviceManager

if __name__ == "__main__":
    app = QApplication(sys.argv)
    engine = QQmlApplicationEngine()
    
    # Expose backend to QML
    device_manager = DeviceManager()
    engine.rootContext().setContextProperty("deviceManager", device_manager)
    
    # Load main QML
    engine.load("ui/main.qml")
    
    if not engine.rootObjects():
        sys.exit(-1)
    
    sys.exit(app.exec())
```

**Example QML (ui/main.qml):**

```qml
import QtQuick
import QtQuick.Controls
import QtQuick.Layouts

ApplicationWindow {
    visible: true
    width: 1280
    height: 800
    title: "NeuroComm DemoBox"
    
    ColumnLayout {
        anchors.fill: parent
        
        ToolBar {
            Layout.fillWidth: true
            RowLayout {
                Button {
                    text: "Connect"
                    onClicked: deviceManager.connect()
                }
                Button {
                    text: "Start"
                    enabled: deviceManager.connected
                    onClicked: deviceManager.start()
                }
            }
        }
        
        TabBar {
            id: tabBar
            Layout.fillWidth: true
            TabButton { text: "Configuration" }
            TabButton { text: "Monitoring" }
            TabButton { text: "Logs" }
        }
        
        StackLayout {
            currentIndex: tabBar.currentIndex
            ConfigPanel {}
            MonitoringPanel {}
            LogViewer {}
        }
    }
}
```

**ĞœĞ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ Ğ½Ğ° C++/Qt:**
ĞŸĞ¾ÑĞ»Ğµ ÑÑ‚Ğ°Ğ±Ğ¸Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ñ€Ğ¾Ñ‚Ğ¾Ñ‚Ğ¸Ğ¿Ğ° Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ° Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ğ¿Ğ¾ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ¾Ğ² Ğ½Ğ° C++ (ĞµÑĞ»Ğ¸ Ğ¿Ğ¾Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ÑÑ).


**Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ñ:**
- **MVP (Phase 0-2):** Electron + React Ğ´Ğ»Ñ ÑĞºĞ¾Ñ€Ğ¾ÑÑ‚Ğ¸ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸
- **Production (Phase 3+):** ĞœĞ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ Ğ½Ğ° Qt/C++ Ğ´Ğ»Ñ performance

### 7.2 Communication

**USB CDC:**
- C/C++: libusb, Qt SerialPort
- Node.js: serialport (Ğ´Ğ»Ñ Electron)
- Python: pyserial

**Protocol:**
- Serialization: msgpack-c, msgpack-python, msgpack-lite (Node.js)
- CRC: crcmod (Python), boost::crc (C++), crc (npm)

**Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ñ:** msgpack Ğ´Ğ»Ñ binary efficiency + JSON Ğ´Ğ»Ñ human-readable configs

### 7.3 Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ

**Charts/Graphs:**
- Qt: Qt Charts (commercial) Ğ¸Ğ»Ğ¸ QCustomPlot (open-source)
- Electron: Plotly.js, Chart.js, D3.js
- Python: PyQtGraph (real-time), matplotlib (static)

**Real-time visualization:**
- Ğ¢Ñ€ĞµĞ±ÑƒĞµÑ‚ÑÑ high-frequency updates (16 ms Ğ´Ğ»Ñ VAD map)
- Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ñ: OpenGL-based rendering (Qt Quick 2D renderer, WebGL Ğ´Ğ»Ñ Electron)
- Downsampling Ğ´Ğ»Ñ display (Ğ½Ğµ Ğ½ÑƒĞ¶Ğ½Ğ¾ Ñ€ĞµĞ½Ğ´ĞµÑ€Ğ¸Ñ‚ÑŒ ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ sample)

**Logs:**
- Virtual scrolling Ğ´Ğ»Ñ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ñ… Ğ¾Ğ±ÑŠĞµĞ¼Ğ¾Ğ² Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… (react-window, Qt QAbstractItemView)
- Syntax highlighting Ğ´Ğ»Ñ structured logs (highlight.js, Kate editor)

### 7.4 Audio Recording

**Libraries:**
- C++: libsndfile (WAV I/O), PortAudio (capture)
- Python: soundfile, wave
- Node.js: node-wav, pcm-convert

**Compression:**
- FLAC Ğ´Ğ»Ñ lossless compression (libFLAC)
- Opus Ğ´Ğ»Ñ lossy compression (ĞµÑĞ»Ğ¸ Ğ½ÑƒĞ¶Ğ½Ğ° ÑĞºĞ¾Ğ½Ğ¾Ğ¼Ğ¸Ñ Ğ¼ĞµÑÑ‚Ğ°)

### 7.5 Data Storage

**Configuration:**
- JSON (Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾Ñ‚Ğ°, human-readable)
- YAML (ĞµÑĞ»Ğ¸ Ğ½ÑƒĞ¶Ğ½Ñ‹ ĞºĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸Ğ¸)
- SQLite (ĞµÑĞ»Ğ¸ Ğ½ÑƒĞ¶Ğ½Ğ° Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ñ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¹)

**Logs:**
- Plain text (.log) Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾Ñ‚Ñ‹
- SQLite Ğ´Ğ»Ñ structured querying (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)
- Compression: gzip Ğ´Ğ»Ñ Ğ°Ñ€Ñ…Ğ¸Ğ²Ğ½Ñ‹Ñ… Ğ»Ğ¾Ğ³Ğ¾Ğ²

---

## 8. ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚Ñ‹ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ (MVP)

### Phase 0: ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ½Ñ‹Ğ¹ Ñ„ÑƒĞ½Ğ´Ğ°Ğ¼ĞµĞ½Ñ‚ (2-3 Ğ½ĞµĞ´ĞµĞ»Ğ¸)
- Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ»Ğ° UART (framing, CRC, sequencing)
- Device discovery Ğ¸ handshake
- Mock-ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ¾ Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ±ĞµĞ· hardware
- Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ UI framework (Ğ¾ĞºĞ½Ğ¾ + Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ)

**Deliverables:**
- Working protocol implementation + tests
- Mock device simulator
- Skeleton UI with device connection

### Phase 1: Ğ‘Ğ°Ğ·Ğ¾Ğ²Ğ°Ñ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ (3-4 Ğ½ĞµĞ´ĞµĞ»Ğ¸)
- ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğº ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ñƒ Ñ‡ĞµÑ€ĞµĞ· USB
- ĞÑ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ Ğ»Ğ¾Ğ³Ğ° ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹ (real-time)
- Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ñ… Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ² (VAD threshold, markers)
- Start/Stop control
- Ğ˜Ğ½Ğ´Ğ¸ĞºĞ°Ñ†Ğ¸Ñ ÑÑ‚Ğ°Ñ‚ÑƒÑĞ° ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ° (mode, PTT, VAD)

**Deliverables:**
- Working device connection
- Real-time log viewer
- Basic parameter configuration
- Device status panel

### Phase 2: Ğ ĞµĞ¶Ğ¸Ğ¼Ñ‹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ (3-4 Ğ½ĞµĞ´ĞµĞ»Ğ¸)
- Ğ’ÑĞµ 4 Ñ€ĞµĞ¶Ğ¸Ğ¼Ğ° (AI-VOX, PRO, PRO+SR, VE)
- State machine visualization
- VAD map visualization
- Session management (timeout, commands)
- KWS/SR monitoring (basic)

**Deliverables:**
- Mode switching
- State machine diagram (live)
- VAD map timeline
- Session timeout handling

### Phase 3: Ğ Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ½Ğ°Ñ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ (2-3 Ğ½ĞµĞ´ĞµĞ»Ğ¸)
- Ğ’ÑĞµ Ğ±Ğ»Ğ¾ĞºĞ¸ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ² (Input/Output/Sensory/VE)
- Debug flags (Ñ Ğ³Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²ĞºĞ¾Ğ¹ Ğ¸ Ğ¿Ñ€ĞµÑĞµÑ‚Ğ°Ğ¼Ğ¸)
- Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ/Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¹
- Bandwidth monitoring

**Deliverables:**
- Complete parameter UI
- Debug flags management
- Config save/load
- UART bandwidth indicator

### Phase 4: Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¸ Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ° (3-4 Ğ½ĞµĞ´ĞµĞ»Ğ¸)
- KWS confidence visualization
- SR distance visualization
- Audio streams monitoring
- Log file management (auto-save, rotation)
- Enhanced real-time graphs

**Deliverables:**
- KWS/SR monitoring UI
- Stream status panel
- Automated log management
- Performance optimization

### Phase 5: Offline Analysis (2-3 Ğ½ĞµĞ´ĞµĞ»Ğ¸)
- Audio recording (all streams)
- Replay functionality
- Session export (ZIP archive)
- Post-processing analysis tools

**Deliverables:**
- Recording interface
- Replay timeline
- Session export/import
- Analysis metrics

### Phase 6: Firmware Update (2-3 Ğ½ĞµĞ´ĞµĞ»Ğ¸)
- Flash Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ (MCU1/MCU2/MCU3)
- Sync configurations
- Backup/Rollback
- Post-flash verification

**Deliverables:**
- Firmware update UI
- Flash progress tracking
- Error recovery
- Version management

### Phase 7: Production Polish (2-3 Ğ½ĞµĞ´ĞµĞ»Ğ¸)
- Error handling refinement
- Performance optimization
- Documentation (user manual, API docs)
- User testing Ğ¸ bug fixes
- Installer/Deployment

**Deliverables:**
- Production-ready application
- User documentation
- Installer packages (Windows/macOS/Linux)
- Release notes

**ĞĞ±Ñ‰Ğ°Ñ Ğ¾Ñ†ĞµĞ½ĞºĞ°:** 19-27 Ğ½ĞµĞ´ĞµĞ»ÑŒ (5-7 Ğ¼ĞµÑÑÑ†ĞµĞ²) Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ²ĞµÑ€ÑĞ¸Ğ¸

**MVP (Phase 0-2):** 8-11 Ğ½ĞµĞ´ĞµĞ»ÑŒ (2-3 Ğ¼ĞµÑÑÑ†Ğ°) Ğ´Ğ»Ñ Ğ±Ğ°Ğ·Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»Ğ°

---

## 11. Development Tools

### 11.1 Mock Device Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

Ğ”Ğ»Ñ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ Ğ¸ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ Ğ±ĞµĞ· Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ hardware Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ğ¾ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ **Mock Device** â€” Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ½Ñ‹Ğ¹ ÑĞ¼ÑƒĞ»ÑÑ‚Ğ¾Ñ€ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ° NeuroComm.

#### 11.1.1 Mock Device Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Desktop Application                â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚      Communication Layer            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                 â”‚                           â”‚
â”‚                 â”‚ USB Serial Interface      â”‚
â”‚                 â”‚                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â”‚ Virtual COM Port (socat/com0com)
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚    Mock Device Simulator            â”‚   â”‚
â”‚  â”‚                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  Protocol Handler            â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  State Machine (MCU2)        â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  VAD/VE Emulator (MCU1)      â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  Scenario Player             â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                             â”‚
â”‚          Mock Device Process                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 11.1.2 Mock Device Features

**1. Protocol Emulation:**
- ĞŸĞ¾Ğ»Ğ½Ğ°Ñ ÑĞ¼ÑƒĞ»ÑÑ†Ğ¸Ñ UART Ğ¿Ñ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ»Ğ° (framing, CRC, sequencing)
- ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ²ÑĞµÑ… ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´ (CMD_SET_MODE, CMD_SET_PARAMS, etc.)
- Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ñ‹Ñ… responses (ACK/NACK, STATUS, PARAMS)

**2. State Machine Emulation:**
- Ğ­Ğ¼ÑƒĞ»ÑÑ†Ğ¸Ñ Ğ²ÑĞµÑ… 4 Ñ€ĞµĞ¶Ğ¸Ğ¼Ğ¾Ğ² (AI-VOX, PRO, PRO+SR, VE)
- ĞŸĞµÑ€ĞµÑ…Ğ¾Ğ´Ñ‹ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğ¹ ÑĞ¾Ğ³Ğ»Ğ°ÑĞ½Ğ¾ State Diagrams v1.3.5
- Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ: VAD Start/Stop, KWS trigger, SR Confirmed/Rejected

**3. Audio Data Generation:**
- Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ ÑĞ¸Ğ½Ñ‚ĞµÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… audio frames (sine wave, noise, speech-like)
- VAD bitmap generation (configurable voice/silence patterns)
- LC3-encoded frames (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)

**4. Configurable Behavior:**
- ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° Ğ·Ğ°Ğ´ĞµÑ€Ğ¶ĞµĞº (latency simulation)
- Ğ˜Ğ½ÑŠĞµĞºÑ†Ğ¸Ñ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº (protocol errors, CRC mismatches, timeouts)
- Event frequency control (VAD events rate, KWS trigger probability)

**5. Scenario Playback:**
- Ğ’Ğ¾ÑĞ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ Ğ·Ğ°Ğ¿Ğ¸ÑĞ°Ğ½Ğ½Ñ‹Ñ… Ñ€ĞµĞ°Ğ»ÑŒĞ½Ñ‹Ñ… ÑĞµÑÑĞ¸Ğ¹
- Scenario files Ğ² JSON Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğµ
- Step-by-step execution Ñ Ğ¿Ğ°ÑƒĞ·Ğ°Ğ¼Ğ¸

#### 11.1.3 Mock Device Implementation

**CLI interface:**

```bash
# Start mock device on virtual COM port
python mock_device.py --port /dev/ttyUSB0 --mode AI-VOX-PRO

# Run with scenario
python mock_device.py --port COM5 --scenario scenarios/test_session_01.json

# Enable debug logging
python mock_device.py --port COM5 --debug --log mock.log

# Inject errors (10% packet loss, 5% CRC errors)
python mock_device.py --port COM5 --packet-loss 0.1 --crc-errors 0.05
```

**Scenario file format:**

```json
{
  "scenario": {
    "name": "AI-VOX PRO Basic Session",
    "description": "User says cmd1, talks for 5 seconds, says cmd4",
    "duration": 10.0,
    "events": [
      {
        "time": 0.0,
        "type": "connection",
        "action": "connected"
      },
      {
        "time": 0.5,
        "type": "vad",
        "action": "start",
        "params": {"chunk_id": 30}
      },
      {
        "time": 0.6,
        "type": "kws",
        "action": "detected",
        "params": {"cmd_id": 1, "confidence": 0.92}
      },
      {
        "time": 0.7,
        "type": "session",
        "action": "active"
      },
      {
        "time": 1.0,
        "type": "vad",
        "action": "start"
      },
      {
        "time": 1.5,
        "type": "ptt",
        "action": "on"
      },
      {
        "time": 5.0,
        "type": "vad",
        "action": "stop"
      },
      {
        "time": 5.1,
        "type": "ptt",
        "action": "off"
      },
      {
        "time": 8.0,
        "type": "vad",
        "action": "start"
      },
      {
        "time": 8.2,
        "type": "kws",
        "action": "detected",
        "params": {"cmd_id": 4, "confidence": 0.88}
      },
      {
        "time": 8.3,
        "type": "session",
        "action": "closed"
      }
    ]
  }
}
```

**Mock Device API:**

```python
from mock_device import MockDevice

# Create mock device
mock = MockDevice(port="/dev/ttyUSB0")

# Configure behavior
mock.set_mode("AI-VOX PRO")
mock.set_latency(50)  # 50ms response latency
mock.enable_error_injection(packet_loss=0.05)

# Start mock device
mock.start()

# Send events programmatically
mock.trigger_vad_start(chunk_id=42)
mock.trigger_kws_detection(cmd_id=1, confidence=0.95)
mock.trigger_sr_confirmed()

# Wait for scenario completion
mock.wait_for_completion()

# Stop mock device
mock.stop()
```

#### 11.1.4 Integration with Test Framework

```python
# Example pytest test using mock device
import pytest
from mock_device import MockDevice
from app.backend.device_manager import DeviceManager

@pytest.fixture
def mock_device():
    mock = MockDevice(port="/dev/ttyUSB0")
    mock.start()
    yield mock
    mock.stop()

def test_ai_vox_pro_session(mock_device):
    # Load scenario
    mock_device.load_scenario("scenarios/test_session_01.json")
    
    # Connect app to mock device
    device_manager = DeviceManager()
    device_manager.connect("/dev/ttyUSB0")
    
    # Wait for scenario to complete
    mock_device.wait_for_completion(timeout=15.0)
    
    # Assertions
    assert device_manager.current_mode == "AI-VOX PRO"
    assert device_manager.session_active is False
    assert len(device_manager.events) >= 8
```

#### 11.1.5 Virtual COM Port Setup

**Windows (com0com):**
```bash
# Install com0com from sourceforge
# Create pair: COM5 <-> COM6
# App connects to COM5, Mock device to COM6
```

**Linux (socat):**
```bash
# Create virtual serial ports
socat -d -d pty,raw,echo=0 pty,raw,echo=0
# Returns: /dev/pts/3 <-> /dev/pts/4
# App connects to /dev/pts/3, Mock device to /dev/pts/4
```

**macOS (socat):**
```bash
# Install socat via Homebrew
brew install socat
# Create virtual serial ports
socat -d -d pty,raw,echo=0 pty,raw,echo=0
```

### 11.2 Session Recorder Ğ´Ğ»Ñ Mock Scenarios

**Recording real device sessions:**

```python
from app.utils.session_recorder import SessionRecorder

# Record real device session for replay
recorder = SessionRecorder(device="/dev/ttyUSB0")
recorder.start_recording("output/session_real_01.json")

# ... interact with device ...

recorder.stop_recording()
# Generates scenario file compatible with mock device
```

**Recorded session can be replayed:**
```bash
python mock_device.py --port COM5 --scenario output/session_real_01.json
```

**Benefits:**
- Test against real-world scenarios
- Reproduce bugs from field testing
- Share test scenarios between team members
- Regression testing with recorded sessions

---


## 12. Extensibility and Plugin System

### 12.1 Plugin Architecture

ĞŸÑ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°Ñ‚ÑŒ ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ¾Ğ² Ğ´Ğ»Ñ Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ñ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸ Ğ±ĞµĞ· Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ core ĞºĞ¾Ğ´Ğ°.

#### 12.1.1 Plugin Types

**1. Message Handler Plugins:**
- ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° custom protocol messages
- Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ½Ğ¾Ğ²Ñ‹Ñ… ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´ Ğ±ĞµĞ· Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ ProtocolHandler

**2. Visualization Plugins:**
- ĞšĞ°ÑÑ‚Ğ¾Ğ¼Ğ½Ñ‹Ğµ Ğ¿Ğ°Ğ½ĞµĞ»Ğ¸ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ (charts, graphs, 3D)
- Integration Ñ Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ğ¼Ğ¸ visualization libraries (Plotly, Matplotlib, Vispy)

**3. Export Plugins:**
- Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ² Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ñ‹ (CSV, Excel, HDF5, MATLAB)
- Integration Ñ external systems (InfluxDB, Elasticsearch, S3)

**4. Algorithm Plugins:**
- Post-processing Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· (spectral analysis, SNR calculation)
- Real-time filtering (Kalman, Butterworth)

#### 12.1.2 Plugin API

**Plugin base class:**

```python
from abc import ABC, abstractmethod
from typing import Dict, Any

class Plugin(ABC):
    """Base class for all plugins"""
    
    @abstractmethod
    def get_info(self) -> Dict[str, str]:
        """Return plugin metadata"""
        return {
            "name": "Plugin Name",
            "version": "1.0.0",
            "author": "Author Name",
            "description": "Plugin description"
        }
    
    @abstractmethod
    def initialize(self, app_context: Any):
        """Called when plugin is loaded"""
        pass
    
    @abstractmethod
    def shutdown(self):
        """Called when plugin is unloaded"""
        pass
```

**Message Handler Plugin Example:**

```python
from plugin_api import Plugin, MessageHandler
import struct

class CustomMessagePlugin(Plugin, MessageHandler):
    def get_info(self):
        return {
            "name": "Custom Message Handler",
            "version": "1.0.0",
            "author": "NeuroComm Team"
        }
    
    def initialize(self, app_context):
        self.device_manager = app_context.device_manager
        # Register handler for custom message ID
        self.device_manager.register_handler(0xF0, self.handle_custom_message)
    
    def handle_custom_message(self, message_id: int, payload: bytes):
        """Handle custom protocol message"""
        # Parse payload
        data = struct.unpack("<HHf", payload)
        
        # Process data
        result = self.custom_processing(data)
        
        # Emit event to UI
        self.emit_event("custom_event", result)
    
    def custom_processing(self, data):
        # Custom algorithm
        return {"processed": data}
    
    def shutdown(self):
        self.device_manager.unregister_handler(0xF0)
```

**Visualization Plugin Example:**

```python
from plugin_api import Plugin, VisualizationPanel
from PySide6.QtWidgets import QWidget
import pyqtgraph as pg
import numpy as np

class SpectrogramPlugin(Plugin, VisualizationPanel):
    def get_info(self):
        return {
            "name": "Real-time Spectrogram",
            "version": "1.0.0",
            "description": "Shows frequency content of audio"
        }
    
    def initialize(self, app_context):
        self.app = app_context
        
        # Create panel widget
        self.panel = self.create_panel()
        
        # Register panel in UI
        app_context.ui.register_panel("Spectrogram", self.panel)
        
        # Subscribe to audio data
        app_context.telemetry.subscribe("audio_frame", self.on_audio_frame)
    
    def create_panel(self):
        panel = QWidget()
        self.plot = pg.PlotWidget()
        self.img = pg.ImageItem()
        self.plot.addItem(self.img)
        
        # Setup spectrogram visualization
        self.spectrogram_data = np.zeros((100, 128))
        
        return panel
    
    def on_audio_frame(self, frame_data):
        # Compute FFT
        fft = np.fft.rfft(frame_data['pcm'])
        spectrum = np.abs(fft)
        
        # Update spectrogram
        self.spectrogram_data = np.roll(self.spectrogram_data, -1, axis=0)
        self.spectrogram_data[-1, :] = spectrum[:128]
        self.img.setImage(self.spectrogram_data.T)
    
    def shutdown(self):
        self.app.ui.unregister_panel("Spectrogram")
        self.app.telemetry.unsubscribe("audio_frame", self.on_audio_frame)
```

**Export Plugin Example:**

```python
from plugin_api import Plugin, Exporter
import scipy.io as sio
from typing import Dict

class MatlabExportPlugin(Plugin, Exporter):
    def get_info(self):
        return {
            "name": "MATLAB Exporter",
            "version": "1.0.0",
            "description": "Export sessions to MATLAB .mat format"
        }
    
    def initialize(self, app_context):
        self.app = app_context
        
        # Register export format in UI
        app_context.ui.register_export_format(
            name="MATLAB (.mat)",
            handler=self.export_to_matlab,
            file_extension=".mat"
        )
    
    def export_to_matlab(self, session_data: Dict, filepath: str):
        """Export session data to MATLAB format"""
        matlab_data = {
            'audio': session_data['audio_frames'],
            'vad_map': session_data['vad_bitmap'],
            'events': session_data['events'],
            'parameters': session_data['parameters'],
            'timestamp': session_data['timestamp'],
            'mode': session_data['mode']
        }
        
        sio.savemat(filepath, matlab_data)
    
    def shutdown(self):
        self.app.ui.unregister_export_format("MATLAB (.mat)")
```

#### 12.1.3 Plugin Management

**Plugin Manager:**

```python
from pathlib import Path
from typing import List, Dict
import importlib.util

class PluginManager:
    def __init__(self, plugin_dir: str):
        self.plugin_dir = Path(plugin_dir)
        self.plugins = {}
    
    def load_plugin(self, plugin_path: str) -> Plugin:
        """Load plugin from file"""
        spec = importlib.util.spec_from_file_location("plugin", plugin_path)
        module = importlib.util.module_from_spec(spec)
        spec.loader.exec_module(module)
        
        # Find Plugin subclass
        for item in dir(module):
            obj = getattr(module, item)
            if isinstance(obj, type) and issubclass(obj, Plugin) and obj != Plugin:
                plugin = obj()
                self.plugins[plugin.get_info()['name']] = plugin
                return plugin
    
    def unload_plugin(self, plugin_name: str):
        """Unload plugin"""
        if plugin_name in self.plugins:
            self.plugins[plugin_name].shutdown()
            del self.plugins[plugin_name]
    
    def list_plugins(self) -> List[Dict]:
        """List all loaded plugins"""
        return [p.get_info() for p in self.plugins.values()]
    
    def enable_plugin(self, plugin_name: str):
        """Enable plugin"""
        if plugin_name in self.plugins:
            self.plugins[plugin_name].initialize(self.app_context)
    
    def disable_plugin(self, plugin_name: str):
        """Disable plugin"""
        if plugin_name in self.plugins:
            self.plugins[plugin_name].shutdown()
```

**Plugin directory structure:**

```
plugins/
â”œâ”€â”€ custom_message_handler/
â”‚   â”œâ”€â”€ plugin.py
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â””â”€â”€ README.md
â”œâ”€â”€ spectrogram_visualizer/
â”‚   â”œâ”€â”€ plugin.py
â”‚   â”œâ”€â”€ ui/
â”‚   â”‚   â””â”€â”€ spectrogram.qml
â”‚   â””â”€â”€ requirements.txt
â””â”€â”€ matlab_exporter/
    â”œâ”€â”€ plugin.py
    â””â”€â”€ requirements.txt
```

**Plugin manifest (in plugin.py header):**

```python
# Plugin Manifest
__plugin_name__ = "Custom Message Handler"
__plugin_version__ = "1.0.0"
__plugin_author__ = "NeuroComm Team"
__plugin_description__ = "Handles custom protocol messages"
__plugin_requires__ = ["numpy>=1.20", "scipy>=1.7"]
__plugin_api_version__ = "2.1"

# Plugin class
class CustomMessagePlugin(Plugin, MessageHandler):
    # ... implementation ...
```

#### 12.1.4 Plugin UI Management

**Settings â†’ Plugins Panel:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Plugin Management                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Installed Plugins:                          â”‚
â”‚                                             â”‚
â”‚ âœ“ Custom Message Handler          v1.0.0   â”‚
â”‚   by NeuroComm Team                         â”‚
â”‚   Status: Enabled                           â”‚
â”‚   [Disable] [Configure] [Uninstall]         â”‚
â”‚                                             â”‚
â”‚ âœ“ Real-time Spectrogram            v1.2.0   â”‚
â”‚   by John Doe                               â”‚
â”‚   Status: Enabled                           â”‚
â”‚   [Disable] [Configure] [Uninstall]         â”‚
â”‚                                             â”‚
â”‚ â˜ MATLAB Exporter                  v1.0.0   â”‚
â”‚   by NeuroComm Team                         â”‚
â”‚   Status: Disabled                          â”‚
â”‚   [Enable] [Configure] [Uninstall]          â”‚
â”‚                                             â”‚
â”‚ [Install Plugin...] [Reload All]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 12.2 Python API for External Integration

**Exposing API Ğ´Ğ»Ñ automation Ğ¸ scripting:**

```python
# Example: Control app from Python script
from neurocomm_app import NeuroCommAPI

# Connect to running app instance (via IPC/socket)
api = NeuroCommAPI.connect()

# Connect to device
api.connect_device(port="/dev/ttyUSB0")

# Set parameters
api.set_vad_params(threshold=0.6, start_marker=4)
api.set_mode("AI-VOX PRO")

# Start recording
api.start_recording("output/session_01.wav")

# Register callback for events
@api.on_event("vad_start")
def on_vad_start(event):
    print(f"VAD started at chunk {event['chunk_id']}")

# Wait for user interaction...
import time
time.sleep(30)

# Stop recording
api.stop_recording()

# Disconnect
api.disconnect_device()
```

**CLI wrapper for scripting:**

```bash
# Command-line interface for automation
neurocomm-cli connect /dev/ttyUSB0
neurocomm-cli set-mode AI-VOX-PRO
neurocomm-cli set-param vad.threshold 0.6
neurocomm-cli start-recording output/session.wav
sleep 30
neurocomm-cli stop-recording
neurocomm-cli disconnect

# Batch operations
neurocomm-cli batch-test --config tests/config.yaml --output results/
```

**REST API (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾, Ğ´Ğ»Ñ remote control):**

```python
# Start REST API server in app
from flask import Flask, jsonify, request

app = Flask(__name__)

@app.route('/api/device/connect', methods=['POST'])
def api_connect():
    port = request.json['port']
    result = device_manager.connect(port)
    return jsonify({"status": "ok" if result else "error"})

@app.route('/api/device/status', methods=['GET'])
def api_status():
    status = device_manager.get_status()
    return jsonify(status)

@app.route('/api/params/set', methods=['POST'])
def api_set_params():
    params = request.json
    device_manager.set_params(params)
    return jsonify({"status": "ok"})

# Start server
app.run(host='localhost', port=5000)
```

**Use cases:**
- Automated testing scripts
- CI/CD integration
- Remote control for demo purposes
- Batch processing multiple devices
- Integration with other tools (JIRA, Slack notifications)

---



## 9. Ğ Ğ¸ÑĞºĞ¸ Ğ¸ Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ñ

### 9.1 Ğ¢ĞµÑ…Ğ½Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ñ€Ğ¸ÑĞºĞ¸

**R1: UART bandwidth limitations**
- **Ğ Ğ¸ÑĞº:** ĞĞµĞ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¾Ğ´Ğ½Ğ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ¾Ğ¹ Ğ¿ĞµÑ€ĞµĞ´Ğ°Ñ‡Ğ¸ Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¸Ñ… Ğ°ÑƒĞ´Ğ¸Ğ¾ Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ² Ğ½Ğ° 500k
- **Ğ’ĞµÑ€Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚ÑŒ:** Ğ’Ñ‹ÑĞ¾ĞºĞ°Ñ
- **Ğ’Ğ»Ğ¸ÑĞ½Ğ¸Ğµ:** ĞšÑ€Ğ¸Ñ‚Ğ¸Ñ‡Ğ½Ğ¾Ğµ (Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸)
- **ĞœĞ¸Ñ‚Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ:** 
  - ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ², Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¾Ñ‚ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ½ĞµĞ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ñ…
  - Warning Ğ¿ĞµÑ€ĞµĞ´ Ğ¿ĞµÑ€ĞµĞ³Ñ€ÑƒĞ·ĞºĞ¾Ğ¹
  - Bandwidth calculator Ğ² UI
- **Fallback:** Upgrade to 1M baud (Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ hardware ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸)

**R2: Protocol Ğ²ĞµÑ€ÑĞ¸Ğ¸ Ğ¸ backward compatibility**
- **Ğ Ğ¸ÑĞº:** Desktop app v1.0 Ğ½Ğµ ÑĞ¼Ğ¾Ğ¶ĞµÑ‚ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ Ñ Ğ½Ğ¾Ğ²Ñ‹Ğ¼Ğ¸ Ğ²ĞµÑ€ÑĞ¸ÑĞ¼Ğ¸ firmware
- **Ğ’ĞµÑ€Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚ÑŒ:** Ğ¡Ñ€ĞµĞ´Ğ½ÑÑ
- **Ğ’Ğ»Ğ¸ÑĞ½Ğ¸Ğµ:** Ğ’Ñ‹ÑĞ¾ĞºĞ¾Ğµ (Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ğ¸ Ğ½Ğµ ÑĞ¼Ğ¾Ğ³ÑƒÑ‚ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ FW)
- **ĞœĞ¸Ñ‚Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ:** 
  - Protocol version negotiation Ğ² handshake
  - Graceful degradation Ğ´Ğ»Ñ ÑÑ‚Ğ°Ñ€Ñ‹Ñ… Ğ²ĞµÑ€ÑĞ¸Ğ¹
  - Version compatibility matrix Ğ² Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ğ¸
- **Fallback:** Multiple protocol implementations Ğ² Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¸

**R3: State synchronization Ğ¿Ñ€Ğ¸ reconnect**
- **Ğ Ğ¸ÑĞº:** Device state Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒÑÑ while disconnected (Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€, Ñ‡ĞµÑ€ĞµĞ· MCU3 Ğ´Ğ¶Ğ¾Ğ¹ÑÑ‚Ğ¸Ğº)
- **Ğ’ĞµÑ€Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚ÑŒ:** Ğ¡Ñ€ĞµĞ´Ğ½ÑÑ
- **Ğ’Ğ»Ğ¸ÑĞ½Ğ¸Ğµ:** Ğ¡Ñ€ĞµĞ´Ğ½ĞµĞµ (confusion Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ)
- **ĞœĞ¸Ñ‚Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ:** 
  - Full state resync Ğ¿Ğ¾ÑĞ»Ğµ reconnect
  - Conflict resolution UI (user choice)
  - Visual indicator Ğ´Ğ»Ñ outdated state
- **Fallback:** Force device reset to known state

**R4: Real-time visualization performance**
- **Ğ Ğ¸ÑĞº:** UI lag Ğ¿Ñ€Ğ¸ Ğ²Ñ‹ÑĞ¾ĞºĞ¾Ğ¹ Ñ‡Ğ°ÑÑ‚Ğ¾Ñ‚Ğµ debug events (VAD map ĞºĞ°Ğ¶Ğ´Ñ‹Ğµ 16 ms)
- **Ğ’ĞµÑ€Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚ÑŒ:** Ğ¡Ñ€ĞµĞ´Ğ½ÑÑ
- **Ğ’Ğ»Ğ¸ÑĞ½Ğ¸Ğµ:** Ğ¡Ñ€ĞµĞ´Ğ½ĞµĞµ (UX degradation)
- **ĞœĞ¸Ñ‚Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ:** 
  - Buffering + downsampling Ğ´Ğ»Ñ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸
  - Separate rendering thread
  - Adaptive quality (reduce resolution Ğ¿Ñ€Ğ¸ Ğ²Ñ‹ÑĞ¾ĞºĞ¾Ğ¹ Ğ½Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞµ)
- **Fallback:** ĞĞ¿Ñ†Ğ¸Ñ "Reduce visualization quality" Ğ´Ğ»Ñ ÑĞ»Ğ°Ğ±Ñ‹Ñ… PC

**R5: Memory leaks Ğ² long-running sessions**
- **Ğ Ğ¸ÑĞº:** Memory footprint Ñ€Ğ°ÑÑ‚Ñ‘Ñ‚ ÑĞ¾ Ğ²Ñ€ĞµĞ¼ĞµĞ½ĞµĞ¼, eventual crash
- **Ğ’ĞµÑ€Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚ÑŒ:** Ğ¡Ñ€ĞµĞ´Ğ½ÑÑ
- **Ğ’Ğ»Ğ¸ÑĞ½Ğ¸Ğµ:** ĞšÑ€Ğ¸Ñ‚Ğ¸Ñ‡Ğ½Ğ¾Ğµ (application crash)
- **ĞœĞ¸Ñ‚Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ:**
  - Circular buffers Ñ Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ½Ñ‹Ğ¼ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ğ¾Ğ¼
  - Periodic garbage collection
  - Memory profiling Ğ² CI/CD
- **Fallback:** Auto-restart after N hours (Ñ Ğ¿Ñ€ĞµĞ´ÑƒĞ¿Ñ€ĞµĞ¶Ğ´ĞµĞ½Ğ¸ĞµĞ¼)

### 9.2 ĞŸĞ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ñ

**L1: USB CDC driver differences (Windows/macOS/Linux)**
- **Windows:** Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ Ğ´Ñ€Ğ°Ğ¹Ğ²ĞµÑ€Ğ° (libusb Ğ¸Ğ»Ğ¸ vendor-specific)
- **macOS:** built-in support, Ğ½Ğ¾ Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ÑÑ approval Ğ´Ğ»Ñ unsigned apps
- **Linux:** Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ÑÑ udev rules Ğ´Ğ»Ñ non-root access

**ĞœĞ¸Ñ‚Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ:**
- Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ cross-platform Ğ±Ğ¸Ğ±Ğ»Ğ¸Ğ¾Ñ‚ĞµĞºÑƒ (serialport Ğ´Ğ»Ñ Node.js, Qt SerialPort Ğ´Ğ»Ñ Qt)
- Installer Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ drivers/permissions Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸
- Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ´Ğ»Ñ manual setup

**L2: UI framework limitations**
- **Electron:** Ğ±Ğ¾Ğ»ÑŒÑˆĞ¾Ğ¹ memory footprint (> 100 MB), Ğ½Ğ¾ Ğ¿Ñ€Ğ¾ÑÑ‚Ğ°Ñ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°
- **Qt:** Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ½Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ, Ğ½Ğ¾ ÑĞ»Ğ¾Ğ¶Ğ½ĞµĞµ Ğ´Ğ»Ñ web-Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸ĞºĞ¾Ğ²
- **Python+PyQt:** Ğ±Ñ‹ÑÑ‚Ñ€Ğ°Ñ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°, Ğ½Ğ¾ Ğ¼ĞµĞ´Ğ»ĞµĞ½Ğ½Ğ°Ñ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ

**Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ñ:** Ğ’Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ² Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ¾Ñ‚ Ğ¿Ñ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚Ğ¾Ğ² (speed vs performance)

**L3: Firewall/Antivirus false positives**
- **Ğ Ğ¸ÑĞº:** Antivirus Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ USB communication Ğ¸Ğ»Ğ¸ Ğ¿Ğ¾Ğ¼ĞµÑ‡Ğ°Ñ‚ÑŒ app ĞºĞ°Ğº malware
- **ĞœĞ¸Ñ‚Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ:**
  - Code signing certificate Ğ´Ğ»Ñ Windows/macOS
  - Whitelist submission Ğ´Ğ»Ñ major antivirus vendors
  - Clear communication Ğ² installer

### 9.3 ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒÑĞºĞ¸Ğµ Ñ€Ğ¸ÑĞºĞ¸

**U1: Ğ¡Ğ»Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑĞ° Ğ´Ğ»Ñ Ğ½ĞµÑ‚ĞµÑ…Ğ½Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹**
- **ĞœĞ¸Ñ‚Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ:** 
  - Wizard Ğ´Ğ»Ñ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ½Ğ°Ñ‡Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸
  - ĞŸÑ€ĞµÑĞµÑ‚Ñ‹ Ğ´Ğ»Ñ Ñ‚Ğ¸Ğ¿Ğ¾Ğ²Ñ‹Ñ… ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸ĞµĞ²
  - Contextual help Ğ¸ tooltips
- **Fallback:** "Simple mode" Ñ Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ½Ñ‹Ğ¼ Ğ½Ğ°Ğ±Ğ¾Ñ€Ğ¾Ğ¼ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ²

**U2: ĞĞµĞ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ°Ñ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ Ğ¼Ğ¾Ğ¶ĞµÑ‚ "ĞºĞ¸Ñ€Ğ¿Ğ¸Ñ‡Ğ¸Ñ‚ÑŒ" ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ¾**
- **ĞœĞ¸Ñ‚Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ:** 
  - Validation Ğ¿ĞµÑ€ĞµĞ´ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¾Ğ¹ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ²
  - Safe defaults
  - Emergency reset button
  - Warning Ğ´Ğ»Ñ ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¹
- **Fallback:** Bootloader Ñ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒÑ reflash Ñ‡ĞµÑ€ĞµĞ· USB (hardware-level)

**U3: Data loss Ğ¿Ñ€Ğ¸ crash**
- **ĞœĞ¸Ñ‚Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ:**
  - Auto-save Ğ´Ğ»Ñ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¹ (ĞºĞ°Ğ¶Ğ´Ñ‹Ğµ 30 ÑĞµĞº)
  - Crash recovery (restore last state)
  - Periodic backup
- **Fallback:** Manual save reminder Ğ¿ĞµÑ€ĞµĞ´ ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡Ğ½Ñ‹Ğ¼Ğ¸ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸ÑĞ¼Ğ¸

---

## 10. Ğ¡Ğ²ÑĞ·Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ñ‹

- `01_2026_NC_architecture_v1.3.6.md` â€” ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ° NeuroComm
- `NeuroComm_State_Diagrams_v1.3.6.md` â€” State diagrams Ğ¸ sequence diagrams Ğ´Ğ»Ñ Ñ€ĞµĞ¶Ğ¸Ğ¼Ğ¾Ğ² Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹
- `UART_Protocol_Spec_v1.3.5.md` â€” Ğ¡Ğ¿ĞµÑ†Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ»Ğ° MCU2â†”MCU1
- `NeuroComm_UI_Spec_v1.0.md` â€” Ğ¡Ğ¿ĞµÑ†Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ UI ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ° (MCU3)
- `Debug_Tool_Spec.md` â€” Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑĞ¿ĞµÑ†Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ debug-Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¹ (TBD)

---

## Changelog

| Ğ’ĞµÑ€ÑĞ¸Ñ | Ğ”Ğ°Ñ‚Ğ° | Ğ˜Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ |
|--------|------|-----------|
| 2.1 | 2026-02-12 | Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ñ‹ Ğ´Ğ¾Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ Ğ¸Ğ· ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ Ñ NC_DemoBox_App_Architecture_v1_0:<br>- Ğ Ğ°Ğ·Ğ´ĞµĞ» 3.9.1: Configuration Presets System (Ğ²ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ½Ñ‹Ğµ Ğ¿Ñ€ĞµÑĞµÑ‚Ñ‹ Ğ´Ğ»Ñ Ñ‚Ğ¸Ğ¿Ğ¾Ğ²Ñ‹Ñ… ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸ĞµĞ²)<br>- Ğ Ğ°Ğ·Ğ´ĞµĞ» 3.11.1: Audio Codecs Support (LC3 Decoder integration, FLAC support)<br>- Ğ Ğ°Ğ·Ğ´ĞµĞ» 3.12.5: Logging Implementation Details (Python logging module, structured logging)<br>- Ğ Ğ°Ğ·Ğ´ĞµĞ» 4.2: Firmware Update Commands (Ğ´ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ» Ğ¿Ñ€Ğ¾ÑˆĞ¸Ğ²ĞºĞ¸)<br>- Ğ Ğ°Ğ·Ğ´ĞµĞ» 4.6: Threading Model (Ğ¼Ğ½Ğ¾Ğ³Ğ¾Ğ¿Ğ¾Ñ‚Ğ¾Ñ‡Ğ½Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ´Ğ»Ñ responsiveness)<br>- Ğ Ğ°Ğ·Ğ´ĞµĞ» 7.1: PySide6+QML Recommendation (Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ñ Ñ‚ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ ÑÑ‚ĞµĞºĞ°)<br>- Ğ Ğ°Ğ·Ğ´ĞµĞ» 11: Development Tools (Mock Device Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ±ĞµĞ· hardware)<br>- Ğ Ğ°Ğ·Ğ´ĞµĞ» 12: Extensibility and Plugin System (ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ¾Ğ²) |
| 1.0 | 2026-02-12 | ĞŸĞµÑ€Ğ²Ğ°Ñ Ğ²ĞµÑ€ÑĞ¸Ñ Ğ½Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ UI screenshots Ğ¸ architecture doc |
| 2.0 | 2026-02-12 | Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ñ‹ ĞºĞ¾Ñ€Ñ€ĞµĞºÑ†Ğ¸Ğ¸ Ğ½Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ State Diagrams v1.3.6, UI Spec v1.0, UART Protocol v1.3.5:<br>- Ğ£Ñ‚Ğ¾Ñ‡Ğ½ĞµĞ½Ğ¾ Ñ€Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ĞµĞ½Ğ½Ğ¾ÑÑ‚Ğ¸ MCU1/MCU2/MCU3<br>- Ğ”ĞµÑ‚Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½ Ğ¿Ñ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ» Ğ¾Ğ±Ğ¼ĞµĞ½Ğ° (Ğ»Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ¸, framing, bandwidth limitations)<br>- Ğ Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ñ‹ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ VAD (timing, buffer mechanics)<br>- Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½ VE Contract (BYPASS requirement)<br>- Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½ Session Management (timeout, phases)<br>- Ğ Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ñ‹ Debug Flags (ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸, UART load)<br>- Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ° State Machine Visualization<br>- Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ° KWS/SR Monitoring<br>- Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ° Audio Streams Monitoring<br>- Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ° Offline Analysis (recording, replay)<br>- Ğ”ĞµÑ‚Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½ Firmware Update (backup, rollback)<br>- Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½ Device Discovery Ğ¸ Handshake<br>- Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½ Log File Management (auto-save, rotation, export)<br>- Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½ Stream Manager (bandwidth monitoring)<br>- ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ñ‹ Ğ¿Ñ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚Ñ‹ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ (Phase 0-7)<br>- Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½ Ñ€Ğ°Ğ·Ğ´ĞµĞ» Ğ Ğ¸ÑĞºĞ¸ Ğ¸ ĞĞ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ñ |

---

**Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚ ÑƒÑ‚Ğ²ĞµÑ€Ğ¶Ğ´Ñ‘Ğ½:** [ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑÑŒ, Ğ´Ğ°Ñ‚Ğ°]  
**Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ Ğ¿ĞµÑ€ĞµÑĞ¼Ğ¾Ñ‚Ñ€:** Q2 2026

#### 3.9.1 Configuration Presets System

**Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¸:**
- Ğ’ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ½Ñ‹Ğµ Ğ¿Ñ€ĞµÑĞµÑ‚Ñ‹ Ğ´Ğ»Ñ Ñ‚Ğ¸Ğ¿Ğ¾Ğ²Ñ‹Ñ… ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸ĞµĞ²
- Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒÑĞºĞ¸Ñ… Ğ¿Ñ€ĞµÑĞµÑ‚Ğ¾Ğ²
- Export/Import Ğ¿Ñ€ĞµÑĞµÑ‚Ğ¾Ğ² Ğ¼ĞµĞ¶Ğ´Ñƒ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ°Ğ¼Ğ¸
- Sharing Ğ¿Ñ€ĞµÑĞµÑ‚Ğ¾Ğ² Ğ² ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğµ

**Ğ’ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ½Ñ‹Ğµ Ğ¿Ñ€ĞµÑĞµÑ‚Ñ‹:**

> **ĞŸÑ€Ğ¸Ğ¼ĞµÑ‡Ğ°Ğ½Ğ¸Ğµ:** VAD Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ (Start marker, Stop marker, threshold) Ğ·Ğ°Ğ´Ğ°ÑÑ‚ÑÑ Ñ‡ĞµÑ€ĞµĞ· Desktop App Ğ¿Ñ€Ğ¸ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞµ Ğ¸ Ğ·Ğ°Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ÑÑ‚ÑÑ Ğ½Ğ° ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ¾. ĞŸĞ¾ÑĞ»Ğµ Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸ Ğ¾Ğ½Ğ¸ **Ğ½Ğµ Ğ¼ĞµĞ½ÑÑÑ‚ÑÑ Ğ² Ñ€Ğ°Ğ½Ñ‚Ğ°Ğ¹Ğ¼Ğµ** â€” Ğ½Ğ¸ Ğ¾Ğ´Ğ¸Ğ½ MCU Ğ½Ğµ Ğ¸Ğ·Ğ¼ĞµĞ½ÑĞµÑ‚ Ğ¸Ñ… Ğ¿Ñ€Ğ¸ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¸ Ñ€ĞµĞ¶Ğ¸Ğ¼Ğ¾Ğ² AI-VOX / PRO / PRO+SR. Â«Ğ•Ğ´Ğ¸Ğ½Ñ‹Ğµ Ğ´Ğ»Ñ Ğ²ÑĞµÑ… Ñ€ĞµĞ¶Ğ¸Ğ¼Ğ¾Ğ²Â» Ğ¾Ğ·Ğ½Ğ°Ñ‡Ğ°ĞµÑ‚: Ğ·Ğ°Ğ´Ğ°Ğ½Ñ‹ Ğ¾Ğ´Ğ½Ğ¾ĞºÑ€Ğ°Ñ‚Ğ½Ğ¾ Ñ‡ĞµÑ€ĞµĞ· Desktop, Ñ„Ğ¸ĞºÑĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹ Ğ½Ğ° Ğ²ĞµÑÑŒ ÑĞµĞ°Ğ½Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹.

| Preset | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ |
|--------|----------|-------------------|
| **Indoor Quiet** | Ğ¢Ğ¸Ñ…Ğ¾Ğµ Ğ¿Ğ¾Ğ¼ĞµÑ‰ĞµĞ½Ğ¸Ğµ (Ğ¾Ñ„Ğ¸Ñ, Ğ´Ğ¾Ğ¼) | VAD threshold: 0.45, Start marker: 3, VE mode: DISABLED |
| **Outdoor Noisy** | Ğ¨ÑƒĞ¼Ğ½Ğ°Ñ ÑƒĞ»Ğ¸Ñ†Ğ°, Ğ²ĞµÑ‚ĞµÑ€ | VAD threshold: 0.65, Start marker: 5, VE mode: ENABLED (TX+RX) |
| **Car Environment** | ĞĞ²Ñ‚Ğ¾Ğ¼Ğ¾Ğ±Ğ¸Ğ»ÑŒ (ÑˆÑƒĞ¼ Ğ´Ğ²Ğ¸Ğ³Ğ°Ñ‚ĞµĞ»Ñ, Ğ´Ğ¾Ñ€Ğ¾Ğ³Ğ°) | VAD threshold: 0.70, VE increase: 1.6, Start marker: 4 |
| **Factory Floor** | ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´ÑÑ‚Ğ²Ğ¾ (Ğ¾Ñ‡ĞµĞ½ÑŒ ÑˆÑƒĞ¼Ğ½Ğ¾) | VAD threshold: 0.75, VE increase: 2.0, Start marker: 6 |
| **Default (Balanced)** | Ğ£Ğ½Ğ¸Ğ²ĞµÑ€ÑĞ°Ğ»ÑŒĞ½Ğ°Ñ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ | VAD threshold: 0.55, Start marker: 4, VE mode: ENABLED (TX only) |

**ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒÑĞºĞ¸Ğµ Ğ¿Ñ€ĞµÑĞµÑ‚Ñ‹:**
- Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ñ‚ĞµĞºÑƒÑ‰ĞµĞ¹ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸ ĞºĞ°Ğº preset (Ñ Ğ¸Ğ¼ĞµĞ½ĞµĞ¼)
- Ğ ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ñ… Ğ¿Ñ€ĞµÑĞµÑ‚Ğ¾Ğ²
- Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒÑĞºĞ¸Ñ… Ğ¿Ñ€ĞµÑĞµÑ‚Ğ¾Ğ²
- Sharing Ğ¿Ñ€ĞµÑĞµÑ‚Ğ¾Ğ² (export/import .yaml Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²)

**UI Ğ´Ğ»Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ¿Ñ€ĞµÑĞµÑ‚Ğ°Ğ¼Ğ¸:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Configuration Presets                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Built-in Presets:                           â”‚
â”‚ â— Indoor Quiet                              â”‚
â”‚ â— Outdoor Noisy                             â”‚
â”‚ â— Car Environment                           â”‚
â”‚ â— Factory Floor                             â”‚
â”‚ â— Default (Balanced)                        â”‚
â”‚                                             â”‚
â”‚ [Load] [View Details]                       â”‚
â”‚                                             â”‚
â”‚ â”€â”€â”€ User Presets â”€â”€â”€                        â”‚
â”‚ â— My Office Setup                           â”‚
â”‚ â— Warehouse Config                          â”‚
â”‚ â— Test Setup 2024-02-12                     â”‚
â”‚                                             â”‚
â”‚ [Load] [Edit] [Delete] [Export]             â”‚
â”‚                                             â”‚
â”‚ Current Configuration:                      â”‚
â”‚ [Save as Preset...] [Import Preset...]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚ preset Ñ„Ğ°Ğ¹Ğ»Ğ° (.yaml):**

```yaml
preset:
  name: "Car Environment"
  description: "Optimized for in-car communication"
  author: "NeuroComm Team"
  version: "1.0"
  created: "2026-02-12T14:30:00Z"
  
  parameters:
    vad:
      threshold: 0.70
      gain: 1.0
      start_marker_size: 4
      stop_marker_size: 5
      chunk_ms: 16
    
    ve:
      mode: ENABLED
      increase: 1.6
      gain: 1.0
      rx_enable: 1
      tx_enable: 1
    
    input:
      mode: BOTH_INPUTS
      first_gain: 1.2
      second_gain: 0.8
    
    output:
      first_output_gain: 1.0
      second_output_gain: 1.0
    
    sensory:
      kws_timeout: 5
      sensory_gain: 1.2
      audio_source: MIC_BYPASS
    
    session:
      timeout: 30
      command_timeout: 5
  
  metadata:
    recommended_mode: "AI-VOX PRO"
    environment: "car"
    noise_level: "high"
    tags: ["automotive", "high-noise", "mobile"]
```

**Preset management API:**
```python
class PresetManager:
    def load_preset(self, name: str) -> Dict[str, Any]:
        """Load preset by name (built-in or user)"""
    
    def save_preset(self, name: str, config: Dict[str, Any]):
        """Save current config as user preset"""
    
    def delete_preset(self, name: str):
        """Delete user preset"""
    
    def export_preset(self, name: str, filepath: str):
        """Export preset to YAML file"""
    
    def import_preset(self, filepath: str) -> str:
        """Import preset from YAML file, returns preset name"""
    
    def list_presets(self) -> List[PresetInfo]:
        """List all available presets (built-in + user)"""
```



**5. Firmware Update Commands:**

```
# Firmware update flow (App â†’ MCU3 â†’ target MCU)
CMD_ENTER_BOOTLOADER(target_mcu)    # ĞŸĞµÑ€ĞµĞ²ĞµÑÑ‚Ğ¸ MCU Ğ² bootloader mode
CMD_FLASH_ERASE(start_addr, size)   # Ğ¡Ñ‚ĞµÑ€ĞµÑ‚ÑŒ flash region
CMD_FLASH_WRITE(addr, data_chunk)   # Ğ—Ğ°Ğ¿Ğ¸ÑĞ°Ñ‚ÑŒ chunk firmware
CMD_FLASH_VERIFY(start_addr, size, crc) # Ğ’ĞµÑ€Ğ¸Ñ„Ğ¸Ñ†Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ğ¸ÑĞ°Ğ½Ğ½Ğ¾Ğµ
CMD_FLASH_RESET()                   # ĞŸĞµÑ€ĞµĞ·Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚ÑŒ MCU Ğ¿Ğ¾ÑĞ»Ğµ Ğ¿Ñ€Ğ¾ÑˆĞ¸Ğ²ĞºĞ¸
CMD_FLASH_ABORT()                   # ĞŸÑ€ĞµÑ€Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾ÑˆĞ¸Ğ²ĞºÑƒ

# Firmware update notifications (Device â†’ App)
FLASH_PROGRESS(percent, bytes_written) # ĞŸÑ€Ğ¾Ğ³Ñ€ĞµÑÑ Ğ¿Ñ€Ğ¾ÑˆĞ¸Ğ²ĞºĞ¸
FLASH_ERROR(error_code, description)   # ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¾ÑˆĞ¸Ğ²ĞºĞ¸
FLASH_COMPLETE(target_mcu, new_version) # ĞŸÑ€Ğ¾ÑˆĞ¸Ğ²ĞºĞ° Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ°
```

**Firmware update protocol sequence:**

1. **Enter bootloader:**
   ```
   App â†’ Device: CMD_ENTER_BOOTLOADER(MCU1)
   Device â†’ App: ACK(bootloader_ready)
   ```

2. **Erase flash:**
   ```
   App â†’ Device: CMD_FLASH_ERASE(0x08000000, 256KB)
   Device â†’ App: FLASH_PROGRESS(10%, erase_in_progress)
   Device â†’ App: ACK(erase_complete)
   ```

3. **Write chunks (loop):**
   ```
   for each chunk (1KB):
       App â†’ Device: CMD_FLASH_WRITE(addr, chunk_data)
       Device â†’ App: FLASH_PROGRESS(N%, bytes_written)
       Device â†’ App: ACK(write_ok)
   ```

4. **Verify:**
   ```
   App â†’ Device: CMD_FLASH_VERIFY(0x08000000, 256KB, crc32)
   Device â†’ App: ACK(verify_ok) or FLASH_ERROR(crc_mismatch)
   ```

5. **Reset:**
   ```
   App â†’ Device: CMD_FLASH_RESET()
   Device â†’ App: FLASH_COMPLETE(MCU1, v1.6.0)
   ```

**Error handling:**
- Connection lost during flash â†’ CMD_FLASH_ABORT + auto-recovery attempt
- Verification failed â†’ retry write (max 3 attempts) â†’ offer rollback
- Bootloader timeout â†’ force reset + manual recovery procedure
- Incompatible firmware â†’ reject before flashing (version check)


